<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NC 1 Eagles - Botros Race</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-primary: #0f172a;
            --bg-secondary: rgba(30, 41, 59, 0.75);
            --bg-tertiary: rgba(51, 65, 85, 0.75);
            --bg-locked: rgba(71, 85, 105, 0.75);
            --accent-cyan: #06b6d4;
            --accent-green: #22c55e;
            --accent-red: #ef4444;
            --accent-yellow: #facc15;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background-image: url('https://v15mbanna3.github.io/my-sounds/Botros%20race.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: var(--text-primary);
            margin: 0;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        main { width: 100%; max-width: 900px; }

        .screen-container { width: 100%; padding: 1.5rem; border: 1px solid rgba(51, 65, 85, 0.5); border-radius: 1.5rem; background-color: rgba(15, 23, 42, 0.85); backdrop-filter: blur(10px); box-sizing: border-box; display: none; position: relative; overflow: hidden; }
        .screen-container.active { display: block; }
        .screen-title { font-size: 2rem; font-weight: 900; text-align: center; margin-top: 0; margin-bottom: 2rem; color: var(--accent-cyan); text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        .screen-subtitle { text-align: center; color: var(--text-secondary); font-size: 1rem; margin-top: -1.5rem; margin-bottom: 2rem; max-width: 500px; margin-left: auto; margin-right: auto; }
        .input-field { width: 100%; padding: 0.75rem 1rem; background-color: var(--bg-secondary); border: 1px solid var(--bg-tertiary); border-radius: 0.75rem; font-size: 1rem; color: var(--text-primary); box-sizing: border-box; margin-bottom: 1rem; text-align: right; }
        .btn { width: 100%; padding: 1rem; border-radius: 0.75rem; font-size: 1.125rem; font-weight: 700; border: none; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 0.5rem; }
        .btn:disabled { background-color: var(--bg-locked); color: var(--text-secondary); cursor: not-allowed; }
        .btn-primary { background-color: var(--accent-cyan); color: white; }
        .btn-primary:hover:not(:disabled) { background-color: #0891b2; }
        .btn-secondary { background-color: var(--bg-tertiary); color: var(--text-primary); }
        .btn-secondary:hover:not(:disabled) { background-color: rgba(71, 85, 105, 0.8); }
        .btn-whatsapp { background-color: #25D366; color: white; }
        .btn-whatsapp:hover { background-color: #1DA851; }
        .back-btn { display: inline-block; margin: 2rem auto 0; width: auto; padding: 0.5rem 1rem; font-size: 1rem; }
        #mute-btn { position: fixed; top: 1.5rem; right: 1.5rem; width: 50px; height: 50px; border-radius: 50%; background-color: rgba(255, 255, 255, 0.1); color: white; font-size: 1.5rem; border: 1px solid var(--bg-tertiary); cursor: pointer; z-index: 1000; display: flex; align-items: center; justify-content: center; transition: background-color 0.2s; }
        #mute-btn:hover { background-color: rgba(255, 255, 255, 0.2); }
        #registration-screen .form-container, #join-lobby-screen .form-container { max-width: 400px; margin: auto; text-align: center; }
        .remember-me-container { display: flex; align-items: center; justify-content: center; gap: 0.5rem; margin-bottom: 1.5rem; color: var(--text-secondary); }
        #remember-me-checkbox { width: 1rem; height: 1rem; accent-color: var(--accent-cyan); }
        #main-menu-screen .welcome-container { position: relative; }
        #main-menu-screen .welcome-message { font-size: 1.75rem; font-weight: 900; text-align: center; margin-bottom: 0.5rem; }
        #main-menu-screen .welcome-message .name { color: var(--accent-cyan); }
        #main-menu-screen .welcome-message .teleopti-id-display { font-size: 1rem; color: var(--text-secondary); font-weight: 400; }
        #main-menu-screen .medals-display { text-align: center; font-size: 1.5rem; margin-bottom: 2rem; min-height: 30px;}
        #logout-btn { position: absolute; top: 0; left: 0; background: none; border: none; color: var(--text-secondary); cursor: pointer; padding: 0.5rem; font-size: 0.8rem; }
        #logout-btn:hover { color: var(--accent-red); }
        .tabs-container { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .tab-item { background-color: var(--bg-secondary); padding: 1.5rem 1rem; border-radius: 1rem; text-align: center; font-size: 1rem; font-weight: 700; cursor: pointer; transition: transform 0.2s ease, background-color 0.2s ease; }
        .tab-item .tab-icon { font-size: 2rem; margin-bottom: 0.5rem; line-height: 1; }
        .list-container .list-item { display: flex; justify-content: space-between; align-items: center; background-color: var(--bg-secondary); padding: 1rem; border-radius: 0.75rem; margin-bottom: 0.5rem; }
        .list-container .list-item .item-name { font-weight: 700; font-size: 1rem; }
        .list-container .list-item .item-name .teleopti-id-display { font-size: 0.8rem; color: var(--text-secondary); margin-right: 0.5rem; }
        .list-container .list-item .item-value { font-weight: 700; font-size: 1rem; color: var(--accent-yellow); }
        .list-container .list-item .item-rank { font-weight: 900; font-size: 1.1rem; color: var(--accent-cyan); margin-left: 1rem; }
        
        /* Single Player Styles */
        .tiers-grid, .levels-grid { display: grid; grid-template-columns: 1fr; gap: 1rem; }
        .card { background-color: var(--bg-secondary); padding: 1.5rem; border-radius: 1rem; border: 2px solid var(--bg-tertiary); transition: all 0.2s; }
        .card:not(.locked) { cursor: pointer; }
        .card:not(.locked):hover { border-color: var(--accent-cyan); transform: scale(1.02); }
        .card.locked { background-color: var(--bg-locked); color: var(--text-secondary); cursor: not-allowed; }
        .card-title { font-size: 1.25rem; font-weight: 900; margin: 0 0 0.5rem 0; }
        .card.locked .card-title { color: var(--text-secondary); }
        .card-details { color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;}
        .progress-bar-container { background-color: var(--bg-tertiary); border-radius: 99px; height: 10px; overflow: hidden; margin-top: 1rem; }
        .progress-bar { background-color: var(--accent-green); height: 100%; width: 0%; transition: width 0.5s; }
        .level-card.completed { border-color: var(--accent-green); background-color: rgba(34, 197, 94, 0.1); }


        #online-menu-screen .button-group { display: flex; flex-direction: column; gap: 1rem; max-width: 400px; margin: 2rem auto;}
        #online-lobby-screen .lobby-code-container { padding: 1rem; background-color: var(--bg-primary); border-radius: 0.75rem; text-align: center; margin-bottom: 1rem; }
        #online-lobby-screen .lobby-code { font-size: 2rem; font-weight: 700; letter-spacing: 0.2em; text-align: center; color: var(--accent-cyan); margin-bottom: 0.5rem; user-select: all; cursor: pointer; }
        #online-lobby-screen .lobby-code-label { font-size: 0.9rem; color: var(--text-secondary); }
        #online-lobby-screen .lobby-status { font-size: 1.25rem; font-weight: 700; color: var(--accent-yellow); margin-top: 1rem; text-align: center; min-height: 2rem; }
        #online-lobby-screen .players-list .list-item { justify-content: center; }

        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 2000; opacity: 0; pointer-events: none; transition: opacity 0.3s; }
        .modal.visible { opacity: 1; pointer-events: auto; }
        .modal-content { background-color: var(--bg-primary); padding: 2rem; border-radius: 1rem; text-align: center; border: 1px solid var(--bg-tertiary); max-width: 90%; width: 400px; }
        .modal-title { font-size: 1.5rem; font-weight: 700; color: var(--accent-cyan); margin-top: 0; margin-bottom: 1rem; }
        .modal-body { margin-bottom: 1.5rem; font-size: 1rem; color: var(--text-secondary); }
        .modal-actions { display: flex; gap: 1rem; justify-content: center; }

        #match-screen { text-align: center; }
        #match-header { font-size: 1.5rem; font-weight: 900; margin-bottom: 1rem; display: flex; justify-content: center; align-items: center; gap: 1rem; flex-wrap: wrap; }
        #match-header .name { color: var(--text-primary); }
        #question-counter { font-size: 1rem; color: var(--text-secondary); margin-bottom: 1rem; }
        #timer-container { width: 100%; background-color: var(--bg-tertiary); border-radius: 5px; margin-bottom: 1.5rem; }
        #timer-bar { width: 100%; height: 10px; background-color: var(--accent-red); border-radius: 5px; transition: width 1s linear; }
        #question-text { font-size: 1.75rem; font-weight: 700; margin-bottom: 1.5rem; min-height: 100px; }
        #options-grid { display: grid; grid-template-columns: 1fr; gap: 1rem; margin-bottom: 1.5rem; }
        .option-btn.correct { background-color: var(--accent-green) !important; color: white !important; transform: scale(1.05); }
        .option-btn.wrong { background-color: var(--accent-red) !important; color: white !important; }
        .option-btn.disabled { opacity: 0.6; pointer-events: none; }
        #explanation-box { background-color: rgba(250, 204, 21, 0.1); border: 1px solid var(--accent-yellow); color: var(--text-primary); border-radius: 0.75rem; padding: 1rem; margin-top: 1.5rem; font-size: 1rem; display: none; }
        #explanation-box.visible { display: block; }
        #surrender-banner { display: none; padding: 0.75rem; background-color: var(--accent-red); color: white; text-align: center; font-weight: 700; border-radius: 0.5rem; margin-bottom: 1rem; }
        #game-over-screen .winner-name { color: var(--accent-green); font-size: 2rem; font-weight: 900; }
        #game-over-screen .results-list { margin-top: 2rem; }

        @media (min-width: 768px) {
            .tiers-grid, .levels-grid { grid-template-columns: 1fr 1fr; }
            #options-grid { grid-template-columns: 1fr 1fr; }
            #question-text { font-size: 2rem; }
        }
    </style>
</head>
<body>
    <button id="mute-btn">🔇</button>

    <main>
        <div id="loading-screen" class="screen-container active"><h1 class="screen-title">...جار التحميل</h1></div>
        <div id="registration-screen" class="screen-container"></div>
        <div id="main-menu-screen" class="screen-container"></div>
        <div id="online-menu-screen" class="screen-container"></div>
        <div id="join-lobby-screen" class="screen-container"></div>
        <div id="online-lobby-screen" class="screen-container"></div>
        <div id="leaderboard-screen" class="screen-container"></div>
        <div id="awards-screen" class="screen-container"></div>
        <div id="single-player-menu-screen" class="screen-container"></div>
        <div id="level-select-screen" class="screen-container"></div>
        <div id="match-screen" class="screen-container"></div>
        <div id="game-over-screen" class="screen-container"></div>
    </main>
    <div id="modal" class="modal"></div>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, collection, onSnapshot, query, where, orderBy, limit, serverTimestamp, updateDoc, arrayUnion, runTransaction, getDocs, writeBatch, increment } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAvGDEbWA3UumCa0P4AfFUVv6xxwL5Porc",
            authDomain: "nc1-eagles-race.firebaseapp.com",
            databaseURL: "https://nc1-eagles-race-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "nc1-eagles-race",
            storageBucket: "nc1-eagles-race.appspot.com",
            messagingSenderId: "772415266484",
            appId: "1:772415266484:web:5813cb3355f7298ade81e1"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // --- INTERNAL QUESTION BANK ---
        // !!! ملاحظة هامة: يجب عليك إضافة المزيد من الأسئلة هنا لتظهر في المباريات !!!
        const QUESTION_BANK = [
         {
            "id": 1,
            "question": "حسب الإرشادات العامة، ماذا يجب على الموظف التأكد منه أولاً إذا توقف أوردر تجديد مبكر للعميل 'Abnormal'؟",
            "options": {
              "1": "أن العميل دفع الفاتورة الأخيرة.",
              "2": "أن سرعة العميل مناسبة للباقة الجديدة.",
              "3": "أن بروفايل الـ FV (Fixed Voice) نشط عند العميل.",
              "4": "أن الراوتر الخاص بالعميل يدعم الخدمة."
            },
            "correct_answer": "3",
            "explanation": "النصائح العامة 'Non Technical Tips' تشدد على أنه في حالة توقف أوردر التجديد المبكر (Abnormal)، يجب أولاً التأكد من أن بروفايل FV فعال ونشط."
          },
          {
            "id": 3,
            "question": "لكي يتمكن العميل من استخدام الباقات الإضافية، ما هو الشرط الأساسي المتعلق بالباقة الأساسية؟",
            "options": {
              "1": "أن تكون الباقة الأساسية مدفوعة مقدماً.",
              "2": "أن تكون الباقة الأساسية ذات سرعة عالية.",
              "3": "أن تكون الباقة الأساسية نشطة (Active).",
              "4": "أن يكون قد مر على اشتراكها شهر على الأقل."
            },
            "correct_answer": "3",
            "explanation": "ورد في الملاحظات 'علشان العميل يقدر يستخدم من الباقات الإضافية لازم الباقة الأساسية تكون Active'."
          },
{ "id": 4, "question": "لأي نوع من الحسابات يمكن تقديم طلب 'Recharge by mistake'؟", "options": { "1": "الحسابات الموقوفة مؤقتاً.", "2": "الحسابات الجديدة فقط.", "3": "الحسابات النشطة (Active accounts) فقط.", "4": "جميع أنواع الحسابات." }, "correct_answer": "3", "explanation": "الإرشادات تنص على أن طلب 'Recharge by mistake' يمكن تقديمه للحسابات النشطة فقط." },
             { "id": 5, "question": "المبلغ الموضح للعميل في رسالة تجديد الاشتراك، ماذا يشمل؟", "options": { "1": "قيمة الباقة الأساسية فقط بدون ضرائب.", "2": "قيمة الباقة الأساسية وضريبة القيمة المضافة.", "3": "قيمة الباقة الأساسية والباقات الإضافية.", "4": "قيمة الباقة الأساسية ورسوم إدارية." }, "correct_answer": "2", "explanation": "الإرشادات توضح أن 'المبلغ الموضح للعميل في رسالة تحديد الاشتراك بيكون شامل ضريبة القيمة المضافة وبيكون خاص بالباقة الأساسية فقط'." },
             { "id": 6, "question": "في باقة 'GAMERZ'، كيف يتم حساب استهلاك الجيجا عند ممارسة الألعاب (Gaming)؟", "options": { "1": "الجيجا تُحسب بجيجا.", "2": "الجيجا تُحسب بـ 2 جيجا.", "3": "الجيجا تُحسب بنصف جيجا.", "4": "أول 50 جيجا مجانية." }, "correct_answer": "3", "explanation": "في باقات الألعاب، الجيجا تُحسب بنصف جيجا، مما يعني أن 125 جيجا المخصصة للألعاب تصل فعلياً إلى 250 جيجا من الاستخدام." },
             { "id": 7, "question": "إذا استهلك عميل باقة 'GAMERZ' حصة الألعاب (125 جيجا)، من أين يكمل الاستهلاك؟", "options": { "1": "تتوقف الخدمة حتى التجديد.", "2": "يكمل من الباقة الأساسية (250 جيجا) والجيجا تُحسب بجيجا.", "3": "يمكنه شراء باقة ألعاب إضافية فقط.", "4": "يكمل من الباقة الأساسية والجيجا تُحسب بنصف جيجا." }, "correct_answer": "2", "explanation": "حسب الشرح، 'ولو خلصت ال 125 جيجا ها يكمل الإستهلاك من ال 250 جيجا الأساسية ولكن الجيجا هاتتحسب بجيجا'." },
             { "id": 8, "question": "عندما يقوم عميل باقة 'GAMERZ' بتحميل أو تحديث لعبة من خارج اللعبة نفسها (مثلاً من متجر تطبيقات على الموبايل)، كيف يتم حساب الاستهلاك؟", "options": { "1": "يُخصم من باقة الألعاب (الجيجا بنص جيجا).", "2": "يُخصم من الباقة الأساسية (الجيجا بجيجا).", "3": "لا يتم احتساب الاستهلاك.", "4": "يُخصم نصف الاستهلاك من باقة الألعاب والنصف الآخر من الأساسية." }, "correct_answer": "2", "explanation": "تنص القاعدة على أنه 'لو بيستخدم جهاز غير مخصص لل gaming زي mobile او PC وهيحمل أو هيحدث لعبة من خارج اللعبة نفسها, فالاستهلاك هيتخصم من الباقة الأساسية الجيجا بجيجا'." },
             { "id": 9, "question": "ما هي الميزة الخاصة بالسرعة التي تتيحها باقة 'GAMERZ' للعميل؟", "options": { "1": "تثبيت السرعة عند 30 ميجابت في الثانية لضمان الاستقرار.", "2": "إتاحة سحب أقصى سرعة يتحملها الخط عند الحاجة في الألعاب.", "3": "مضاعفة سرعة الرفع (Upload speed).", "4": "تحديد سرعة الألعاب فقط دون التأثير على باقي الاستخدامات." }, "correct_answer": "2", "explanation": " تذكر أن 'باقة GAMERZ هاتتيح ان الخط يسحب أقصى سرعة يتحملها لو العميل محتاج ده في ال gaming'." },
             { "id": 10, "question": "كيف يظهر استهلاك باقة 'GAMERZ' للعميل على التطبيق أو الموقع؟", "options": { "1": "تظهر باقة واحدة مدمجة بسعة 375 جيجا.", "2": "تظهر باقة الألعاب 125 جيجا منفصلة عن الباقة الأساسية 250 جيجا.", "3": "تظهر الباقة الأساسية فقط.", "4": "تظهر باقة الألعاب بسعة 250 جيجا والباقة الأساسية 250 جيجا." }, "correct_answer": "2", "explanation": "توضح وشرحها أن العميل يرى الباقتين منفصلتين: 'هيظهر مع العميل ال 250 جيجا الاساسيه و ال 125 جيجا لل gaming'." },
             { "id": 11, "question": "أي من الخدمات التالية لا تتأثر بخاصية 'الاستخدام العادل' (Fair Usage Policy)؟", "options": { "1": "باقات WE Space", "2": "التصفح لمواقع التواصل الاجتماعي", "3": "الخط الأرضي (Fixed Voice)", "4": "باقات الإنترنت الإضافية" }, "correct_answer": "3", "explanation": "خاصية الاستخدام العادل تطبق على خدمات الإنترنت لضمان جودة الخدمة لجميع المستخدمين، ولا تنطبق على خدمة المكالمات الصوتية للخط الأرضي." },
             { "id": 12, "question": "ماذا يحدث عند انتهاء باقة الإنترنت الأساسية قبل موعد التجديد؟", "options": { "1": "يتم تجديد الباقة تلقائياً فوراً.", "2": "تتوقف الخدمة تماماً حتى موعد التجديد.", "3": "تنخفض سرعة الإنترنت إلى سرعة منخفضة محددة.", "4": "يتم تحويل العميل إلى نظام الدفع حسب الاستخدام." }, "correct_answer": "3", "explanation": "تنص سياسة معظم باقات الإنترنت على أنه بعد استهلاك السعة الأساسية، لا تتوقف الخدمة ولكن تنخفض السرعة بشكل كبير (غالباً إلى 256 كيلوبت/ثانية) حتى موعد التجديد التالي." },
             { "id": 13, "question": "ما هو الشرط الذي يجب توافره في الخط حتى يتمكن العميل من الاشتراك في باقة 'Nitro' الإضافية؟", "options": { "1": "أن يكون الخط مشتركاً في باقة بسرعة 100 ميجا على الأقل.", "2": "أن تكون الباقة الأساسية للإنترنت نشطة وغير منتهية.", "3": "أن يكون الخط من نوع الألياف البصرية (Fiber).", "4": "أن يكون قد مر على اشتراك العميل عام كامل." }, "correct_answer": "2", "explanation": "لا يمكن إضافة أي باقات سعة إضافية أو تعزيزية إلا إذا كانت الباقة الأساسية للعميل ما زالت سارية ونشطة." },
             { "id": 14, "question": "عندما يقوم العميل بتجديد اشتراكه مبكراً، متى يبدأ تاريخ صلاحية الباقة الجديدة؟", "options": { "1": "يبدأ من تاريخ التجديد المبكر مباشرة.", "2": "يبدأ بعد 24 ساعة من عملية التجديد.", "3": "يبدأ في الموعد الأصلي لتجديد الباقة القديمة.", "4": "يبدأ في أول يوم من الشهر التالي." }, "correct_answer": "1", "explanation": "التجديد المبكر يعني بدء دورة فوترة جديدة فوراً، حيث يتم إضافة السعة الجديدة وتحديد تاريخ الصلاحية لمدة 30 يوماً من تاريخ التجديد." },
             { "id": 15, "question": "ما هو الإجراء الذي يجب على موظف خدمة العملاء اتخاذه أولاً في حال توقف طلب 'تجديد مبكر' للعميل بسبب مشكلة فنية (Abnormal Order)؟", "options": { "1": "رفع شكوى فنية مباشرة.", "2": "التأكد من أن خدمة الهاتف الأرضي (الصوت) تعمل بشكل سليم على الخط.", "3": "الطلب من العميل إعادة تشغيل الراوتر.", "4": "نصح العميل بالانتظار لمدة 24 ساعة." }, "correct_answer": "2", "explanation": "غالباً ما تكون مشاكل طلبات التجديد مرتبطة بملف تعريف الخط نفسه. التأكد من أن الخدمة الصوتية (FV profile) نشطة هو خطوة أولى ضرورية لاستبعاد المشاكل الأساسية قبل تصعيد الأمر." },
             { "id": 46, "question": "ما هو العرض الذي كان متاحاً للعملاء الجدد في عام 2024؟", "options": { "1": "عرض ضعف الباقة.", "2": "عرض الاحتفاظ بالعملاء (Retention).", "3": "عرض Acquisition Promo 2024.", "4": "عرض Vezeeta." }, "correct_answer": "3", "explanation": "عنوان المقال الرئيسي في هو 'Acquisition Promo 2024'، وهو عرض مخصص لجذب العملاء الجدد." },
             { "id": 47, "question": "عندما يسأل عميل عن عروض 'فزيتا' (Vezeeta)، إلى أين يجب توجيه الاستفسار؟", "options": { "1": "إلى قسم العروض الخاصة.", "2": "إلى رابط مقال 'We Space' وتحديداً جزء 'Shamel From Vezeeta'.", "3": "إلى قسم الشكاوى.", "4": "إلى قسم المبيعات المباشرة." }, "correct_answer": "2", "explanation": "في قسم التعليقات، تم الرد على استفسار بخصوص عروض فزيتا برابط مباشر لمقال We Space الذي يحتوي على تفاصيل العرض." },
             { "id": 48, "question": "ما هو الإجراء المتبع بخصوص 'عروض الإلغاء' (Cancellation Promo) التي تُعطى للعميل الذي يرغب في إلغاء اشتراكه؟", "options": { "1": "يتم رفض طلبه وتوجيهه لإنهاء الخدمة.", "2": "يتم تحويله مباشرة إلى قسم الحسابات.", "3": "يتم توجيهه إلى مقالات 'Retention Concession' للحصول على عرض للاحتفاظ به.", "4": "يتم إعطاؤه خصماً ثابتاً بنسبة 10%." }, "correct_answer": "3", "explanation": "ردًا على سؤال حول عروض الإلغاء، تم وضع رابط لمقال 'Retention Concession'، وهي العروض المخصصة للاحتفاظ بالعملاء." },
             { "id": 49, "question": "إذا لم يكن هناك عرض حالي مناسب للعميل، بماذا يجب أن ينصحه الموظف؟", "options": { "1": "بالاتصال مرة أخرى بعد أسبوع.", "2": "بإلغاء الخدمة والعودة لاحقاً.", "3": "بمتابعة الموقع الإلكتروني وصفحات التواصل الاجتماعي الرسمية لمعرفة العروض الجديدة.", "4": "بتقديم طلب خاص لإدارة التسويق." }, "correct_answer": "3", "explanation": "تنص الإجابة النموذجية في قسم التعليقات على توجيه العميل لمتابعة القنوات الرسمية 'لمعرفة العروض الجديدة'." },
             { "id": 50, "question": "ما هو تاريخ آخر تعديل على 'Acquisition Promo 2024'؟", "options": { "1": "26 مايو 2025.", "2": "29 مايو 2025.", "3": "28 أبريل 2025.", "4": "25 مايو 2025." }, "correct_answer": "3", "explanation": null },
             { "id": 51, "question": "ما هو الهدف الرئيسي من عروض 'Retention'؟", "options": { "1": "جذب عملاء جدد للشركة.", "2": "تشجيع العملاء الحاليين على ترقية باقاتهم.", "3": "مكافأة العملاء الأطول بقاءً في الشركة.", "4": "إقناع العملاء الذين ينوون إلغاء اشتراكهم بالبقاء." }, "correct_answer": "4", "explanation": "تُصمم عروض الاحتفاظ (Retention) خصيصاً لتقديمها للعملاء الذين يطلبون إلغاء الخدمة، وذلك كحافز لتشجيعهم على العدول عن قرارهم والاستمرار مع الشركة." },
             { "id": 52, "question": "عندما يستفسر عميل عن عرض ترويجي انتهت صلاحيته، ما هو الرد الأنسب من الموظف؟", "options": { "1": "إمكانية تفعيل العرض له بشكل استثنائي.", "2": "إخباره بأن العرض لم يعد متاحاً ونصحه بمتابعة القنوات الرسمية للعروض الجديدة.", "3": "تسجيل بياناته للاتصال به عند توفر عرض مشابه.", "4": "تحويله إلى قسم التسويق مباشرة." }, "correct_answer": "2", "explanation": "الإجراء الصحيح هو الشفافية مع العميل. يجب إبلاغه بأن العرض قد انتهى وتوجيهه إلى المصادر الرسمية (الموقع الإلكتروني، التطبيق، صفحات التواصل الاجتماعي) ليكون على اطلاع دائم بأحدث العروض المتاحة." },
             { "id": 53, "question": "ماذا يعني مصطلح 'Acquisition Promo' في عالم الاتصالات؟", "options": { "1": "عرض مخصص لعملاء الشركات فقط.", "2": "عرض يهدف إلى جذب مشتركين جدد لم يكونوا عملاء من قبل.", "3": "خصم يتم تطبيقه تلقائياً عند تجديد الاشتراك السنوي.", "4": "عرض يتيح للعملاء تجربة خدمة جديدة مجاناً لفترة محدودة." }, "correct_answer": "2", "explanation": "مصطلح 'Acquisition' يعني 'استحواذ' أو 'اكتساب'، وفي سياق العروض الترويجية، يشير إلى الحملات الموجهة لجذب عملاء جدد إلى شبكة الشركة." },
             { "id": 54, "question": "إذا كان العرض يتضمن 'ضعف الباقة' لمدة 3 أشهر، ماذا يحدث في الشهر الرابع؟", "options": { "1": "يستمر العميل على ضعف الباقة بسعر أعلى.", "2": "يتم تخفيض السرعة إلى النصف.", "3": "تعود الباقة إلى سعتها الأصلية بنفس السعر الأساسي.", "4": "يجب على العميل طلب الاستمرار في العرض يدوياً." }, "correct_answer": "3", "explanation": "العروض المؤقتة تنتهي صلاحيتها تلقائياً. بعد انتهاء فترة العرض (3 أشهر في هذا المثال)، تعود الخدمة إلى حالتها القياسية من حيث السعة والسعر ما لم ينص العرض على خلاف ذلك." },
             { "id": 55, "question": "في حال وجود عرض مرتبط بخدمة إضافية (مثل اشتراك في تطبيق ترفيهي)، من هي الجهة المسؤولة عن حل المشاكل التقنية المتعلقة بالتطبيق نفسه؟", "options": { "1": "قسم الدعم الفني لشركة الاتصالات.", "2": "قسم المبيعات الذي قام بتفعيل العرض.", "3": "فريق الدعم الفني الخاص بالتطبيق الترفيهي.", "4": "العميل مسؤول عن حلها بنفسه." }, "correct_answer": "3", "explanation": "شركة الاتصالات مسؤولة عن تفعيل الاشتراك وتوصيل الخدمة، لكن أي مشاكل تتعلق بأداء التطبيق نفسه (مثل مشاكل تسجيل الدخول، بطء التشغيل، عدم ظهور المحتوى) تكون من اختصاص فريق الدعم الخاص بالشركة المطورة للتطبيق." },
             { "id": 91, "question": "ما هي الأداة الموحدة التي يستخدمها فريق الدعم الفني؟", "options": { "1": "HDM Portal", "2": "CRM", "3": "360 Consolidated system tool", "4": "SharePoint" }, "correct_answer": "3", "explanation": "عنوان المقال في الصفحة الأولى من 'Tech W1_compressed.pdf' هو '360 Consolidated system tool'، ويظهر أنه أداة مستخدمة عبر عدة فرق دعم." },
             { "id": 92, "question": "عند تصعيد شكوى للعميل، ما هي المعلومة الإضافية التي يجب التأكد من الحصول عليها من العميل؟", "options": { "1": "الرقم القومي.", "2": "رقم هاتف محمول ثانوي (Secondary mobile number).", "3": "عنوان البريد الإلكتروني.", "4": "نوع جهاز الراوتر." }, "correct_answer": "2", "explanation": "أول نصيحة هي 'لو هتصعد شكوى للعميل لازم تتأكد اننا اخدنا الـ Secondary mobile number من العميل'." },
             { "id": 93, "question": "، ما هو طراز الراوتر الذي يتم شرح كيفية إخفاء شبكة الواي فاي (SSID) له في التعليقات؟", "options": { "1": "D-link 224", "2": "TP-Link 840", "3": "ZYXEL (VMG3625-T50B)", "4": "Huawei HG630" }, "correct_answer": "3", "explanation": "هناك عدة تعليقات تسأل عن كيفية إخفاء SSID، وتتعلق هذه التعليقات بصفحة راوتر ZYXEL (VMG3625-T50B)." },
             { "id": 94, "question": "، ما هو الإجراء الصحيح عند التعامل مع مشكلة 'Wrong Card and Port' التي تم حلها؟", "options": { "1": "إغلاق التذكرة مباشرة.", "2": "إنشاء تذكرة جديدة للمتابعة.", "3": "استخدام كود إغلاق 'Line stable /no problem found'.", "4": "استخدام كود إغلاق '(38) Stalagmite problem'." }, "correct_answer": "3", "explanation": "الجدول في صفحة 902 من 'Tech W1' يوضح أنه في حالة 'Wrong Card & port' التي لا توجد بها مشكلة الآن، يتم الإنشاء بكود إغلاق (2) 'Line stable /no problem found'." },
             { "id": 95, "question": "ما هي الخطوات المذكورة لعمل 'Reset soft' لجهاز راوتر؟", "options": { "1": "فصل الكهرباء ثم إعادة توصيلها.", "2": "الدخول للإعدادات > System > Reboot.", "3": "الدخول لـ Maintenance > Backup and Restore > Reset.", "4": "الضغط على زر Reset لمدة 30 ثانية." }, "correct_answer": "3", "explanation": "أحد التعليقات يطلب الخطوات ويتم الرد عليه بـ 'steps to make reset soft in cpe steps to make reset soft maintennance ---back up and restore ----- back up and restore ----- reset ------ ok'." },
             { "id": 96, "question": "ماذا يعني مصطلح 'إعادة ضبط المصنع' (Factory Reset) للراوتر؟", "options": { "1": "إعادة تشغيل الراوتر مع الاحتفاظ بالإعدادات.", "2": "مسح جميع الإعدادات المخصصة وإعادة الراوتر إلى حالته الأصلية.", "3": "تحديث برنامج التشغيل (Firmware) للراوتر.", "4": "تغيير كلمة سر الواي فاي فقط." }, "correct_answer": "2", "explanation": "إعادة ضبط المصنع هي عملية جذرية تمحو أي تغييرات قام بها المستخدم (مثل اسم الشبكة، كلمة السر، إعدادات الحماية) وتعيد الجهاز إلى الإعدادات الافتراضية التي جاء بها من المصنع." },
             { "id": 97, "question": "ما هي أول خطوة يجب على المستخدم القيام بها عند مواجهة بطء في سرعة الإنترنت؟", "options": { "1": "تغيير مكان الراوتر.", "2": "إعادة تشغيل جهاز الراوتر والكمبيوتر (أو الهاتف).", "3": "الاتصال بخدمة العملاء فوراً.", "4": "فحص الكابلات وتوصيلاتها." }, "correct_answer": "2", "explanation": "إعادة التشغيل هي أبسط وأسرع خطوة لحل المشاكل المؤقتة، حيث تقوم بتحديث الاتصال ومسح الذاكرة المؤقتة للأجهزة، مما قد يحل مشكلة البطء في كثير من الحالات." },
             { "id": 98, "question": "ما الغرض من إخفاء اسم شبكة الواي فاي (SSID)؟", "options": { "1": "زيادة سرعة الإنترنت.", "2": "منع الراوتر من استقبال التحديثات.", "3": "تقوية إشارة الواي فاي.", "4": "زيادة مستوى الأمان عن طريق جعل الشبكة غير مرئية للعامة." }, "correct_answer": "4", "explanation": "عند إخفاء الـ SSID، لا تظهر الشبكة في قائمة الشبكات المتاحة على الأجهزة. يجب على المستخدم إدخال اسم الشبكة يدوياً للاتصال بها، مما يضيف طبقة حماية إضافية ضد محاولات الاختراق العشوائية." },
             { "id": 99, "question": "عندما تظهر لمبة 'الإنترنت' على الراوتر باللون الأحمر، على ماذا يدل ذلك غالباً؟", "options": { "1": "أن هناك أجهزة كثيرة متصلة بالشبكة.", "2": "أن إشارة الواي فاي ضعيفة.", "3": "وجود مشكلة في الاتصال بالإنترنت من جهة المزود (لا يوجد IP).", "4": "أن الراوتر يحتاج إلى تحديث." }, "correct_answer": "3", "explanation": "اللون الأحمر للمبة الإنترنت يشير عادةً إلى فشل الراوتر في الحصول على عنوان IP صالح من مزود الخدمة، مما يعني وجود مشكلة في الاتصال الخارجي وليس في الشبكة المحلية الداخلية." },
             { "id": 100, "question": "ما هو الفرق الرئيسي بين شبكة Wi-Fi بتردد 2.4 جيجاهرتز وشبكة بتردد 5 جيجاهرتز؟", "options": { "1": "شبكة 5 جيجاهرتز أبطأ ولكنها تغطي مساحة أكبر.", "2": "شبكة 2.4 جيجاهرتز أسرع ولكنها أكثر عرضة للتداخل.", "3": "شبكة 5 جيجاهرتز أسرع وتوفر اتصالاً أكثر استقراراً، لكن مداها أقصر.", "4": "لا يوجد فرق عملي بينهما للمستخدم العادي." }, "correct_answer": "3", "explanation": "تردد 5 جيجاهرتز يوفر قنوات أكثر وسرعات أعلى وتداخلاً أقل من الأجهزة الأخرى (مثل الميكروويف)، لكن إشارته لا تخترق الجدران والعوائق بنفس كفاءة تردد 2.4 جيجاهرتز، مما يجعل مداها أقصر." },
             { "id": 101, "question": "ما هي الوسيلة الأساسية للتحقق من هوية العميل عندما يتصل من خلال تطبيقه الشخصي المسجل (My WE App)؟", "options": { "1": "رقم الهاتف الأرضي.", "2": "الرقم القومي.", "3": "تاريخ ميلاد العميل.", "4": "آخر عملية شحن قام بها." }, "correct_answer": "3", "explanation": "عندما يبدأ العميل الاتصال من داخل بيئة آمنة مثل تطبيقه الخاص، يتم استخدام تاريخ الميلاد كطريقة تحقق سريعة ومبسطة بدلاً من طلب بيانات كاملة." },
             { "id": 102, "question": "إذا قام العميل بالاتصال من تطبيقه الشخصي ولكنه استفسر عن رقم هاتف آخر غير المسجل في التطبيق، فما هو الإجراء الصحيح للتحقق؟", "options": { "1": "يتم استخدام تاريخ الميلاد للتحقق من الرقمين.", "2": "يتم رفض تقديم أي معلومات عن الرقم الآخر.", "3": "يجب اتباع إجراءات التحقق الكاملة الخاصة بالاستعلام عن رقم مختلف.", "4": "يتم إرسال كود تحقق إلى الرقم الآخر." }, "correct_answer": "3", "explanation": "الأمان يتطلب التحقق من ملكية كل خط على حدة. لذلك، عند السؤال عن رقم مختلف، يجب تطبيق سياسة التحقق الكاملة (مثل طلب الرقم القومي واسم العميل) لهذا الرقم تحديداً." },
             { "id": 103, "question": "ما هو شرط الأهلية الرئيسي الذي يجب توافره لدى العميل للاستفادة من خدمة 'سلفني'؟", "options": { "1": "أن يكون لديه اشتراك فعال لمدة عام على الأقل.", "2": "أن يكون الخط في حالة 'إيقاف مؤقت' (Suspended) بسبب انتهاء الباقة.", "3": "أن يكون مشتركاً في أعلى باقة إنترنت.", "4": "أن يكون قد سدد جميع فواتيره مقدماً." }, "correct_answer": "2", "explanation": "خدمة 'سلفني' مصممة كحل طارئ. لذلك، لا تظهر كخيار للعميل إلا عندما تنتهي باقته بالفعل ويدخل الخط في مرحلة التعليق المؤقت للخدمة." },
             { "id": 104, "question": "ماذا يحدث بعد أن يستهلك العميل السعة التي حصل عليها من خدمة 'سلفني'؟", "options": { "1": "يتم تجديد خدمة سلفني تلقائياً مرة أخرى.", "2": "تعود سرعة الإنترنت إلى السرعة المنخفضة (المخنوثة).", "3": "تتوقف الخدمة تماماً حتى يتم الشحن وتجديد الباقة الأساسية.", "4": "يمكنه طلب خدمة سلفني مرة أخرى يدوياً." }, "correct_answer": "2", "explanation": "خدمة سلفني هي حل مؤقت لاستعادة السرعة الكاملة. عند انتهاء سعتها، يعود الخط إلى الحالة التي كان عليها قبل تفعيلها، وهي السرعة المحدودة حتى يتم التجديد." },
             { "id": 105, "question": "عندما يقوم عميل بدفع مبلغ بالخطأ (شحن خاطئ)، ما هي حالة الحساب التي تسمح بتقديم طلب لاسترداد المبلغ؟", "options": { "1": "الحسابات الموقوفة نهائياً (Deactivated).", "2": "الحسابات في فترة السماح.", "3": "الحسابات النشطة (Active) فقط.", "4": "جميع الحسابات بغض النظر عن حالتها." }, "correct_answer": "3", "explanation": "سياسات معالجة الأخطاء المالية تتطلب أن يكون الحساب الذي يتم التعامل معه حساباً فعالاً وقائماً لضمان إمكانية تطبيق التعديلات المالية والمحاسبية بشكل صحيح." },
             { "id": 106, "question": "ما هي المدة الزمنية القياسية (SLA) التي يجب خلالها الرد على استفسار العميل بخصوص متابعة طلب فاتورة إلكترونية؟", "options": { "1": "24 ساعة.", "2": "48 ساعة.", "3": "72 ساعة.", "4": "5 أيام عمل." }, "correct_answer": "2", "explanation": "تم تحديد إطار زمني مدته 48 ساعة كمعيار جودة لضمان معالجة طلبات العملاء المتعلقة بالفواتير الإلكترونية والرد عليها في وقت مناسب." },
             { "id": 107, "question": "إذا حاول العميل الدفع باستخدام Apple Pay وفشلت العملية، ما هي أول نصيحة يجب تقديمها له؟", "options": { "1": "إعادة تشغيل الهاتف.", "2": "التأكد من وجود رصيد كافٍ في البطاقة المرتبطة بالخدمة والتواصل مع البنك.", "3": "حذف التطبيق وإعادة تثبيته.", "4": "محاولة الدفع باستخدام بطاقة ائتمان مختلفة." }, "correct_answer": "2", "explanation": "خدمة Apple Pay هي وسيط دفع. معظم حالات فشل الدفع تكون مرتبطة بالبطاقة نفسها (نقص الرصيد، انتهاء الصلاحية، قيود من البنك المصدر)، لذا يجب التحقق من مصدر الأموال أولاً." },
             { "id": 151, "question": "ماذا يعني الاختصار FTTH في عالم الاتصالات؟", "options": { "1": "إنترنت فائق السرعة عبر الأقمار الصناعية.", "2": "الألياف الضوئية حتى المنزل (Fiber To The Home).", "3": "تقنية دمج خطوط الهاتف لزيادة السرعة.", "4": "شبكة لاسلكية عامة للمناطق المفتوحة." }, "correct_answer": "2", "explanation": "هذا المصطلح يصف البنية التحتية للإنترنت التي تعتمد على توصيل كابلات الألياف الضوئية مباشرة إلى منزل العميل، مما يتيح سرعات واستقراراً أعلى بكثير من الكابلات النحاسية التقليدية." },
             { "id": 152, "question": "عندما يستفسر عميل يسكن في مجمع سكني (Compound) يدعم خدمة FTTH عن كيفية الاشتراك، ما هو الإجراء الأنسب؟", "options": { "1": "إعطاؤه أرقام قسم المبيعات العام.", "2": "تحويل المكالمة إلى الفريق المختص بخدمات FTTH أو توجيهه لنقطة البيع داخل المجمع.", "3": "الطلب منه زيارة أقرب فرع للشركة.", "4": "إبلاغه بأن الاشتراك يتم عبر الإنترنت فقط." }, "correct_answer": "2", "explanation": "المجمعات السكنية التي تدعم FTTH غالبًا ما يكون لها إجراءات اشتراك خاصة أو فرق مبيعات مخصصة. توجيه العميل مباشرة إلى القناة الصحيحة يضمن حصوله على معلومات دقيقة وخدمة أسرع." },
             { "id": 153, "question": "ما هي الميزة الرئيسية لتقنية FTTH مقارنة بتقنية ADSL التقليدية؟", "options": { "1": "أسعارها أقل دائماً.", "2": "لا تحتاج إلى راوتر خاص.", "3": "توفر سرعات أعلى بكثير وتأثر أقل بالمسافة عن السنترال.", "4": "يمكن تركيبها في أي مكان دون الحاجة لبنية تحتية." }, "correct_answer": "3", "explanation": "تعتمد تقنية الألياف الضوئية على الضوء لنقل البيانات، مما يجعلها أقل عرضة لفقدان السرعة مع زيادة المسافة، على عكس تقنية ADSL التي تعتمد على الكابلات النحاسية وتتأثر جودتها بشكل كبير بالبعد عن الكبينة أو السنترال." },
             { "id": 154, "question": "إذا كان العميل يرغب في الانتقال من مزود خدمة آخر إلى WE على نفس بنية FTTH التحتية، ماذا تسمى هذه العملية؟", "options": { "1": "اشتراك جديد (New Subscription).", "2": "تحويل (Migration).", "3": "ترقية (Upgrade).", "4": "إعادة تفعيل (Reactivation)." }, "correct_answer": "2", "explanation": "مصطلح 'Migration' أو التحويل يستخدم لوصف عملية نقل خدمة العميل من شركة إلى أخرى مع البقاء على نفس التكنولوجيا أو البنية التحتية القائمة." },
             { "id": 155, "question": "لماذا قد لا تكون خدمة FTTH متاحة في جميع المناطق؟", "options": { "1": "لأنها تتطلب موافقة أمنية خاصة.", "2": "لأنها باهظة الثمن بالنسبة لجميع العملاء.", "3": "لأنها تتطلب بنية تحتية خاصة (تمديد كابلات الألياف الضوئية) قد لا تكون متوفرة في كل مكان.", "4": "لأنها مخصصة للشركات والمؤسسات فقط." }, "correct_answer": "3", "explanation": "توفير خدمة FTTH يعتمد بشكل كامل على وجود شبكة أرضية من كابلات الألياف الضوئية. عملية إنشاء وتمديد هذه الشبكة مكلفة وتستغرق وقتاً، لذا يتم نشرها على مراحل في المدن والأحياء المختلفة." },
             { "id": 181, "question": "ما هي المدة الزمنية المحددة (SLA) للرد على طلب متابعة الفاتورة الإلكترونية ؟", "options": { "1": "24 ساعة", "2": "48 ساعة", "3": "72 ساعة", "4": "أسبوع عمل" }, "correct_answer": "2", "explanation": "في قسم التعليقات، تم الرد على سؤال بخصوص الـ SLA بـ 'SLA is 48 H as mentioned in first work group SLA'." },
             { "id": 182, "question": " ، إذا اتصل العميل من تطبيقه الخاص (My WE App)، كيف يتم التحقق من هويته؟", "options": { "1": "من خلال آخر 4 أرقام من الرقم القومي.", "2": "من خلال تاريخ الميلاد.", "3": "من خلال رقم الموبايل المسجل.", "4": "لا يتطلب تحقق." }, "correct_answer": "2", "explanation": "التعليقات توضح 'If cst contact us from his own (App /E-care) will verify through Birth date'." },
             { "id": 183, "question": "إذا سأل العميل عن رقم مختلف عن الرقم الذي يتصل منه، ما هو إجراء التحقق المتبع؟", "options": { "1": "التحقق بتاريخ الميلاد فقط.", "2": "اتباع إجراءات التحقق الخاصة برقم مختلف.", "3": "رفض الإجابة على الاستفسار.", "4": "طلب الاتصال من الرقم الآخر." }, "correct_answer": "2", "explanation": "نفس التعليق يضيف 'incase of asking about different number will follow different number verification'." },
             { "id": 184, "question": "، كيف يمكن للعميل تفعيل خدمة 'سلفني' من خلال تطبيق 'My WE'؟", "options": { "1": "عن طريق إرسال رسالة نصية لرقم معين.", "2": "الخدمة تفعل تلقائياً عند انتهاء الباقة.", "3": "بمجرد أن يصبح الخط 'suspended'، تظهر له رسالة الخدمة في التطبيق ويضغط على 'subscribe'.", "4": "عن طريق قائمة الخدمات الإضافية في التطبيق." }, "correct_answer": "3", "explanation": "الرد على استفسار حول طريقة الإضافة من التطبيق كان 'بمجرد م يكون خط العميل suspended هيظهر ليه MSG خدمه Salfny وبعد كدا هيضغط على subscribe'." },
             { "id": 185, "question": "هل يمكن إضافة خدمة 'سلفني' لخط في مرحلة 'suspended lifecycle'؟", "options": { "1": "نعم، يمكن إضافتها في أي وقت.", "2": "لا، لا يمكن.", "3": "نعم، ولكن برسوم إضافية.", "4": "نعم، إذا كان العميل من عملاء VIP." }, "correct_answer": "2", "explanation": "تم الرد بشكل قاطع بـ 'no' على سؤال '?IF the line is suspended lifecycle can i add salfny for him /her'." },
             { "id": 201, "question": "ما هو الإجراء المتبع عند انقطاع المكالمة مع العميل أثناء تقديم طلب أو شكوى؟", "options": { "1": "انتظار العميل حتى يتصل مرة أخرى.", "2": "إلغاء الطلب الذي كان يتم إنشاؤه.", "3": "اتباع عملية 'إعادة الاتصال بالعميل' (Call Back Process) ومحاولة التواصل معه.", "4": "إرسال رسالة نصية للعميل تطلب منه إعادة الاتصال." }, "correct_answer": "3", "explanation": "من أساسيات خدمة العملاء الجيدة هو استكمال الخدمة التي بدأها العميل. لذلك، توجد إجراءات محددة لإعادة الاتصال بالعميل في حالة انقطاع المكالمة لاستكمال طلبه أو حل مشكلته." },
             { "id": 202, "question": "عند تصعيد شكوى فنية للعميل، ما هي المعلومة الإضافية التي من الضروري الحصول عليها لضمان سهولة تواصل الفريق الفني معه؟", "options": { "1": "عنوان البريد الإلكتروني للعميل.", "2": "اسم أقرب فرع للعميل.", "3": "رقم هاتف محمول بديل أو ثانوي (Secondary Mobile Number).", "4": "نوع جهاز الكمبيوتر الذي يستخدمه العميل." }, "correct_answer": "3", "explanation": "قد يكون الهاتف الأساسي للعميل مغلقاً أو غير متاح. الحصول على رقم بديل يزيد من فرص نجاح الفريق الفني في الوصول إلى العميل بسرعة عند الحاجة لزيارة فنية أو متابعة." },
             { "id": 203, "question": "ماذا يعني مصطلح 'WO Request' في سياق متابعة التركيبات؟", "options": { "1": "طلب إلغاء الخدمة (Withdrawal Order).", "2": "أمر عمل أو طلب زيارة فنية (Work Order).", "3": "طلب تعويض للعميل (Waive Off).", "4": "طلب تقرير عن جودة الخدمة (Watchdog Order)." }, "correct_answer": "2", "explanation": "'Work Order' هو مصطلح قياسي يستخدم في أنظمة CRM للإشارة إلى مهمة أو طلب يتم إسناده لفريق ميداني (مثل الفنيين) للقيام بإجراء معين، مثل تركيب خدمة جديدة أو إصلاح عطل." },
             { "id": 204, "question": "إذا تأخر الفني عن الموعد المحدد للتركيب، ما هو الإجراء الأولي الذي يجب على خدمة العملاء اتخاذه؟", "options": { "1": "إلغاء الطلب فوراً.", "2": "إنشاء طلب زيارة فنية (Work Order) لمتابعة سبب التأخير مع القسم المختص.", "3": "الطلب من العميل الانتظار لمدة 48 ساعة إضافية.", "4": "تقديم تعويض فوري للعميل." }, "correct_answer": "2", "explanation": "الإجراء الصحيح هو استخدام الأدوات المتاحة (مثل نظام CRM) لتصعيد المشكلة داخلياً وتوثيقها، وذلك لمعرفة سبب التأخير ومحاولة حل المشكلة وتحديد موعد جديد للعميل." },
             { "id": 205, "question": "ما هو الغرض من نظام إدارة علاقات العملاء (CRM) في شركة اتصالات؟", "options": { "1": "إصدار الفواتير للعملاء فقط.", "2": "مراقبة أداء الموظفين فقط.", "3": "تسجيل وتتبع جميع تفاعلات العملاء وطلباتهم وشكواهم في مكان واحد مركزي.", "4": "إدارة الموقع الإلكتروني للشركة." }, "correct_answer": "3", "explanation": "الهدف الأساسي من نظام CRM هو توفير رؤية شاملة وموحدة لكل عميل، مما يمكّن جميع الأقسام (مبيعات، دعم فني، خدمة عملاء) من خدمته بشكل أفضل بناءً على تاريخه الكامل مع الشركة." },
             { "id": 206, "question": "عندما يتم حل مشكلة فنية تتعلق بـ 'خطأ في الكارت والمنفذ' (Wrong Card & Port) ويتأكد الفني من استقرار الخط، ما هو كود الإغلاق الصحيح الذي يجب استخدامه للشكوى؟", "options": { "1": "(38) مشكلة Stalagmite", "2": "(30) العميل غير متاح", "3": "(2) الخط مستقر / لا توجد مشكلة", "4": "(5) مشكلة في جهاز العميل" }, "correct_answer": "3", "explanation": "طالما تم حل المشكلة الأساسية وأصبح الخط يعمل بشكل طبيعي، فإن كود الإغلاق المناسب هو الذي يعكس الحالة الحالية للخدمة، وهو أن الخط مستقر ولا توجد به مشكلة." },
             { "id": 207, "question": "إذا طلب الفني إغلاق الشكوى لأن العميل لم يكن متاحاً في الموعد المتفق عليه، فما هو كود الإغلاق المناسب لهذه الحالة؟", "options": { "1": "(2) الخط مستقر / لا توجد مشكلة", "2": "(38) مشكلة Stalagmite", "3": "(30) غير متاح بناءً على طلب العميل", "4": "(1) تم حل المشكلة" }, "correct_answer": "3", "explanation": "يتم استخدام هذا الكود تحديداً لتوثيق الحالات التي لم يتمكن فيها الفريق الفني من إتمام المهمة بسبب عدم تمكنهم من الوصول إلى العميل، مما يفرقها عن الحالات التي يتم فيها حل المشكلة فنياً." },
             { "id": 208, "question": "في عملية متابعة التركيبات، إذا كان الطلب في حالة 'معلق' (Pending)، ما هي أول خطوة يجب على الموظف القيام بها عند متابعة حالة العميل؟", "options": { "1": "إلغاء الطلب وإنشاء طلب جديد.", "2": "التحقق من النظام لمعرفة سبب التعليق وتاريخ التحديث المتوقع.", "3": "الطلب من العميل زيارة الفرع.", "4": "نصح العميل بالانتظار دون تحديد مدة." }, "correct_answer": "2", "explanation": "قبل اتخاذ أي إجراء، من الضروري مراجعة البيانات المتاحة في نظام المتابعة لفهم سبب التأخير، فقد يكون هناك سبب فني أو إداري موثق بالفعل، مما يساعد في إعطاء العميل إجابة دقيقة." },
             { "id": 209, "question": "ما هو الغرض من إجراء 'مكالمة ما بعد التركيب' (CSI Outbound call)؟", "options": { "1": "بيع خدمات إضافية للعميل.", "2": "التأكد من رضا العميل عن عملية التركيب وجودة الخدمة الأولية.", "3": "تحصيل رسوم التركيب من العميل.", "4": "تحديث بيانات العميل الشخصية." }, "correct_answer": "2", "explanation": "هذه المكالمة هي جزء من عملية ضمان الجودة، وتهدف إلى قياس تجربة العميل (Customer Satisfaction Index - CSI) والتأكد من أن الخدمة تم تركيبها وتعمل بشكل سليم وحل أي مشاكل أولية قد تواجهه." },
             { "id": 210, "question": "إذا اشتكى العميل من عدم تركيب الخدمة بعد مرور الموعد المحدد بوقت طويل، وتم التأكد من وجود مشكلة تتطلب التصعيد، فما هو الإجراء الصحيح؟", "options": { "1": "الطلب من العميل تقديم شكوى مكتوبة.", "2": "إعطاء العميل رقم قسم الشكاوى.", "3": "إنشاء طلب خدمة (SR) أو تذكرة تصعيد من خلال النظام لتتبع المشكلة مع الأقسام المسؤولة.", "4": "وعد العميل بحل المشكلة دون اتخاذ إجراء مسجل." }, "correct_answer": "3", "explanation": "الإجراء الرسمي يضمن توثيق المشكلة وتعيينها للجهة المسؤولة ومتابعتها حتى الحل. الاعتماد على الوعود الشفهية غير فعال ولا يضمن حل المشكلة." },
             { "id": 251, "question": "أي من الإجراءات التالية يعتبر من مسؤولية العميل للحفاظ على أمان شبكة الواي فاي الخاصة به؟", "options": { "1": "زيادة سرعة باقة الإنترنت.", "2": "تغيير كلمة سر الواي فاي بشكل دوري واستخدام كلمة سر قوية.", "3": "إعادة تشغيل الراوتر يومياً.", "4": "توصيل الراوتر بمثبت تيار كهربائي." }, "correct_answer": "2", "explanation": "كلمة السر هي خط الدفاع الأول ضد الوصول غير المصرح به إلى الشبكة. استخدام كلمة سر قوية (مزيج من الحروف والأرقام والرموز) وتغييرها بانتظام هو أهم خطوة أمنية يمكن للمستخدم اتخاذها." },
             { "id": 252, "question": "عندما يدفع العميل فاتورته عبر تطبيق المحفظة الإلكترونية الخاص به، في حساب من يتم إيداع المبلغ؟", "options": { "1": "في حساب شركة الاتصالات مباشرة.", "2": "في حساب المحفظة الإلكترونية للعميل.", "3": "في حساب وسيط الدفع (Aggregator) الذي يقوم بتحويله لاحقاً.", "4": "في حساب البنك المركزي." }, "correct_answer": "3", "explanation": "تعمل خدمات الدفع الإلكتروني عبر طرف ثالث (وسيط) يقوم بمعالجة المعاملة بين العميل والشركة المقدمة للخدمة، ويضمن تحويل الأموال بشكل آمن." },
             { "id": 253, "question": "ما هو الفرق الجوهري بين 'إعادة التشغيل' (Reboot) و'إعادة ضبط المصنع' (Reset) للراوتر؟", "options": { "1": "لا يوجد فرق، كلاهما يؤدي نفس الوظيفة.", "2": "إعادة التشغيل سريعة، بينما إعادة ضبط المصنع بطيئة.", "3": "إعادة التشغيل تحافظ على الإعدادات، بينما إعادة ضبط المصنع تمسحها بالكامل.", "4": "إعادة التشغيل تصلح مشاكل السرعة، بينما إعادة الضبط تصلح مشاكل الاتصال." }, "correct_answer": "3", "explanation": "إعادة التشغيل (Reboot/Restart) هي مثل إطفاء الجهاز وتشغيله مرة أخرى ولا تؤثر على الإعدادات المحفوظة. أما إعادة ضبط المصنع (Reset) فهي عملية تعيد الجهاز إلى حالته الأصلية وتمحو كل الإعدادات الشخصية." },
             { "id": 254, "question": "ما هي الطريقة الصحيحة التي يجب أن يوضح بها الموظف سعة باقة 'GAMERZ' للعميل؟", "options": { "1": "أن الباقة بسعة 375 جيجا للاستخدام العام.", "2": "أن الباقة بسعة 125 جيجا فقط.", "3": "أن الباقة تتكون من 250 جيجا أساسية بالإضافة إلى 125 جيجا مخصصة للألعاب تُحسب بشكل مختلف لتعطي استخداماً يعادل 250 جيجا.", "4": "أن الباقة بسعة 250 جيجا وتتحول إلى باقة ألعاب تلقائياً." }, "correct_answer": "3", "explanation": "الشفافية والوضوح هما الأهم. يجب شرح مكونات الباقة بدقة: جزء أساسي للاستخدام العام، وجزء مخصص للألعاب له طريقة حساب خاصة (الجيجا بنصف جيجا) لتعظيم الفائدة منه في الألعاب." },
             { "id": 255, "question": "إذا استفسر العميل عن عرض ترويجي لا يعرف عنه الموظف شيئاً، ما هو التصرف السليم؟", "options": { "1": "إخبار العميل بأن هذا العرض غير موجود.", "2": "الطلب من العميل شرح تفاصيل العرض بالكامل.", "3": "البحث في قاعدة المعرفة الداخلية أو سؤال مشرف الفريق للحصول على المعلومة الصحيحة قبل الرد.", "4": "تحويل المكالمة عشوائياً إلى قسم آخر." }, "correct_answer": "3", "explanation": "التصرف المهني يقتضي عدم إعطاء معلومات غير مؤكدة. يجب على الموظف استخدام الموارد المتاحة له للتحقق من المعلومة بدقة لضمان تقديم إجابة صحيحة وموثوقة للعميل." },
             { "id": 256, "question": "ما هو سبب أهمية توثيق كل مكالمة وكل إجراء يتم مع العميل في نظام CRM؟", "options": { "1": "هو إجراء روتيني غير مهم.", "2": "لضمان حصول الموظف على عمولته.", "3": "لتوفير سجل تاريخي كامل للعميل يمكن لجميع الموظفين الرجوع إليه لتقديم خدمة متكاملة ومتسقة.", "4": "لإرسال تقرير يومي للإدارة العليا." }, "correct_answer": "3", "explanation": "التوثيق الدقيق يضمن أنه إذا تواصل العميل مرة أخرى، يمكن لأي موظف آخر أن يفهم تاريخه ومشاكله السابقة والحلول التي تم تقديمها، مما يوفر تجربة أفضل للعميل ويمنع تكرار طرح نفس الأسئلة." },
             { "id": 257, "question": "ما هي أهمية الحصول على رقم هاتف ثانوي من العميل عند إنشاء شكوى فنية؟", "options": { "1": "لإرسال رسائل العروض الجديدة عليه.", "2": "لاستخدامه في تحديث بيانات الحساب.", "3": "لضمان سهولة وصول الفريق الفني إلى العميل في حال كان رقمه الأساسي مغلقًا.", "4": "هو إجراء غير ضروري." }, "correct_answer": "3", "explanation": "يعتبر الحصول على رقم ثانوي إجراءً احترازياً مهماً لضمان عدم تأخر حل الشكوى بسبب صعوبة التواصل مع العميل، خاصة في الحالات التي تتطلب زيارة فنية." },
             { "id": 258, "question": "ماذا يجب على الموظف فعله إذا توقف طلب تجديد باقة مبكر قدمه العميل عبر التطبيق (أصبح في حالة Abnormal)؟", "options": { "1": "إلغاء الطلب فورًا.", "2": "التأكد أولًا من أن خدمة الخط الأرضي الصوتي (Fixed Voice) نشطة على النظام.", "3": "الطلب من العميل إعادة تقديم الطلب مرة أخرى.", "4": "تصعيد شكوى فنية مباشرة." }, "correct_answer": "2", "explanation": "قبل تصعيد المشكلة، يجب استبعاد الأسباب الشائعة. غالبًا ما تكون مشاكل تفعيل الخدمات مرتبطة بملف تعريف الخط نفسه، والتأكد من نشاط الخدمة الصوتية هو أول خطوة تشخيصية أساسية." },
             { "id": 259, "question": "في باقة مخصصة للألعاب (GAMERZ)، إذا قام المستخدم بتحميل تحديث للعبة من متجر التطبيقات على هاتفه المحمول، من أي رصيد يتم خصم هذا الاستهلاك؟", "options": { "1": "من رصيد الألعاب المخصص.", "2": "من رصيد الباقة الأساسية.", "3": "يتم تقسيمه بين الرصيدين.", "4": "لا يتم خصمه." }, "correct_answer": "2", "explanation": "رصيد الألعاب مخصص للاستهلاك الذي يحدث داخل اللعبة نفسها (In-game data). أما عمليات التحميل والتحديث التي تتم عبر المتاجر أو من خارج اللعبة، فتُعتبر استخدامًا عامًا للإنترنت ويُخصم من الباقة الأساسية." },
             { "id": 260, "question": "ما هو الإجراء الصحيح عند التعامل مع عميل يرغب في الإلغاء ويبدي استعداده للبقاء إذا حصل على عرض أفضل؟", "options": { "1": "إبلاغه بعدم وجود عروض وإتمام عملية الإلغاء.", "2": "تحويله مباشرة إلى قسم الفواتير.", "3": "مراجعة العروض المتاحة للاحتفاظ بالعملاء (Retention Offers) وتقديم المناسب له.", "4": "الطلب منه الاتصال في وقت لاحق." }, "correct_answer": "3", "explanation": "الاحتفاظ بالعملاء الحاليين هو أولوية. لذلك، توجد سياسات وعروض مخصصة لمثل هذه الحالات، ويجب على الموظف استخدامها لمحاولة إقناع العميل بالبقاء." },
             { "id": 261, "question": "عندما يقوم العميل بالدفع عن طريق ماكينة دفع إلكتروني خارجية (مثل فوري أو أمان)، وتأخر ظهور المبلغ في حسابه، من هي الجهة التي يجب متابعة المشكلة معها؟", "options": { "1": "البنك الخاص بالعميل.", "2": "شركة الاتصالات فقط.", "3": "الشركة المسؤولة عن ماكينة الدفع (مقدم الخدمة الوسيط).", "4": "العميل مسؤول عن حل المشكلة بنفسه." }, "correct_answer": "3", "explanation": "في هذه الحالة، تكون شركة الاتصالات هي الطرف المستقبِل للأموال، بينما شركة الدفع الإلكتروني هي المسؤولة عن تنفيذ عملية التحويل. لذلك، تبدأ المتابعة مع الوسيط للتأكد من حالة المعاملة من طرفهم." },
             { "id": 262, "question": "أي من أنواع الحسابات التالية لا يمكن إضافة خدمة 'سلفني' الطارئة لها؟", "options": { "1": "الحسابات الجديدة.", "2": "الحسابات التي في مرحلة الإيقاف النهائي (Suspended Lifecycle / Deactivated).", "3": "الحسابات التي عليها فواتير غير مدفوعة.", "4": "حسابات الشركات." }, "correct_answer": "2", "explanation": "خدمة 'سلفني' مخصصة للخطوط الموقوفة مؤقتًا بسبب انتهاء الباقة. أما الخطوط التي دخلت مرحلة الإيقاف لعدم السداد لفترة طويلة، فتكون غير مؤهلة لمثل هذه الخدمات الطارئة." },
             { "id": 263, "question": "كيف يمكن للمستخدم تنفيذ 'إعادة ضبط ناعمة' (Soft Reset) للراوتر من خلال صفحة الإعدادات؟", "options": { "1": "عن طريق فصل كابل الطاقة.", "2": "بالضغط على زر Reset في ظهر الجهاز.", "3": "بالدخول إلى قائمة الصيانة (Maintenance) واختيار إعادة التشغيل (Reboot).", "4": "بحذف شبكة الواي فاي وإعادة إضافتها." }, "correct_answer": "3", "explanation": "'إعادة الضبط الناعمة' أو إعادة التشغيل من داخل إعدادات الراوتر هي طريقة لإعادة إقلاع نظام تشغيل الجهاز دون مسح الإعدادات، وغالبًا ما توجد في قسم الصيانة أو إدارة النظام." },
             { "id": 264, "question": "إذا استفسر عميل يسكن في 'كومبوند القطامية هيلز' عن التحويل إلى خدمة الألياف البصرية (FTTH)، ما هو الإجراء الأنسب الذي يجب على الموظف اتخاذه؟", "options": { "1": "إنشاء طلب اشتراك جديد عادي.", "2": "تحويل المكالمة إلى فريق مبيعات FTTH المختص أو توجيهه لنقطة البيع داخل الكومبوند.", "3": "إبلاغه بأن الخدمة غير متوفرة.", "4": "نصحه بشراء راوتر جديد أولًا." }, "correct_answer": "2", "explanation": "غالبًا ما يكون للمجمعات السكنية الكبرى إجراءات خاصة أو فرق مبيعات مكرسة لخدمات FTTH. التوجيه الصحيح يضمن للعميل الحصول على خدمة سريعة ومعلومات دقيقة عن الباقات والأسعار الخاصة بمنطقته." },
             { "id": 265, "question": "ماذا يشمل المبلغ الذي يظهر للعميل في الرسالة النصية الخاصة بتجديد الاشتراك؟", "options": { "1": "قيمة الباقة الأساسية فقط.", "2": "قيمة الباقة الأساسية مضافًا إليها ضريبة القيمة المضافة.", "3": "قيمة الباقة الأساسية والباقات الإضافية.", "4": "قيمة الباقة الأساسية ورسوم إدارية فقط." }, "correct_answer": "2", "explanation": "لضمان الشفافية، يتم إبلاغ العميل بالمبلغ النهائي المطلوب منه للشحن، والذي يشمل سعر الباقة الأساسية بالإضافة إلى الضرائب المستحقة عليها." },
             { "id": 266, "question": "إذا انقطعت المكالمة أثناء قيام الموظف بجمع بيانات من العميل لعملية التحقق، ما هو الإجراء الصحيح؟", "options": { "1": "اعتبار أن التحقق قد فشل.", "2": "محاولة إعادة الاتصال بالعميل لاستكمال الإجراءات.", "3": "انتظار العميل ليعاود الاتصال.", "4": "تجاهل المكالمة." }, "correct_answer": "2", "explanation": "تنص سياسات خدمة العملاء على ضرورة محاولة إعادة الاتصال بالعميل في حالة انقطاع المكالمة، خاصة أثناء إجراءات مهمة مثل التحقق أو تقديم الطلبات، لضمان استمرارية الخدمة." },
             { "id": 267, "question": "ما هي باقة الإنترنت القديمة التي كانت متاحة للتجديد فقط للعملاء المشتركين فيها بالفعل، ولا يمكن للعملاء الجدد الاشتراك بها؟", "options": { "1": "WE Space", "2": "Super Kicks", "3": "Indigo Plus", "4": "Nitro" }, "correct_answer": "3", "explanation": "تقوم الشركات أحيانًا بإيقاف باقات معينة للعملاء الجدد مع السماح للمشتركين الحاليين بالاستمرار في تجديدها. باقة 'Indigo Plus' هي مثال على هذا النوع من الباقات القديمة." },
             { "id": 268, "question": "ما هي الميزة الخاصة التي توفرها باقات الألعاب (GAMERZ) فيما يتعلق بسرعة الخط؟", "options": { "1": "تضمن سرعة ثابتة لا تتغير أبدًا.", "2": "تسمح بسحب أقصى سرعة يتحملها الخط أثناء اللعب عند الحاجة.", "3": "تضاعف سرعة التحميل (Download) فقط.", "4": "تخفض سرعة التصفح لزيادة سرعة الألعاب." }, "correct_answer": "2", "explanation": "بعض الألعاب تتطلب نطاقًا تردديًا عاليًا جدًا للعمل بكفاءة. هذه الميزة تضمن أن العميل يمكنه الاستفادة من كامل إمكانيات خطه المادية أثناء اللعب لتحقيق أفضل أداء." },
             { "id": 269, "question": "عند إغلاق شكوى فنية تم حلها، أي من الأكواد التالية يستخدم للدلالة على وجود مشكلة في الرايزر أو الكبينة وتم حلها؟", "options": { "1": "(2) الخط مستقر", "2": "(38) مشكلة Stalagmite / Raisers", "3": "(30) العميل غير متاح", "4": "(5) مشكلة في جهاز العميل" }, "correct_answer": "2", "explanation": "يتم استخدام هذا الكود المتخصص لتصنيف وحصر المشاكل التي تتعلق بالبنية التحتية في الكبائن (Stalagmite أو Raiser) بدقة، مما يساعد في التحليل الفني لاحقًا." },
             { "id": 270, "question": "إذا اتصل العميل من تطبيقه (My WE App) وسأل عن باقات الإنترنت، ما هي وسيلة التحقق من هويته؟", "options": { "1": "آخر 4 أرقام من الرقم القومي.", "2": "تاريخ ميلاده.", "3": "رقم العقد.", "4": "لا يتطلب تحققًا." }, "correct_answer": "2", "explanation": "الاتصال من داخل التطبيق يعتبر قناة آمنة وموثقة جزئيًا، لذلك يتم استخدام إجراء تحقق مبسط مثل تاريخ الميلاد لتسهيل الخدمة على العميل." },
             { "id": 271, "question": "ما هو الغرض من الأداة الموحدة للدعم الفني (360 Consolidated system tool)؟", "options": { "1": "تتبع مواقع الفنيين على الخريطة.", "2": "توفير واجهة واحدة للموظف تحتوي على جميع الأدوات والمعلومات اللازمة لتشخيص وحل مشاكل العميل.", "3": "إصدار فواتير العملاء إلكترونيًا.", "4": "نظام لإدارة الحضور والانصراف للموظفين." }, "correct_answer": "2", "explanation": "تهدف هذه الأداة إلى زيادة كفاءة موظف الدعم الفني عن طريق دمج الأنظمة المختلفة في شاشة واحدة، مما يقلل الوقت المستغرق في التنقل بين التطبيقات ويسرّع من حل المشكلة." },
             { "id": 272, "question": "إذا أراد العميل إخفاء شبكة الواي فاي (SSID) على راوتر من نوع ZYXEL، ففي أي قسم من إعدادات الراوتر سيجد هذا الخيار غالبًا؟", "options": { "1": "قسم الصيانة (Maintenance).", "2": "قسم إعدادات الشبكة (Network Setting).", "3": "قسم الأمان (Security).", "4": "قسم التشخيص (Diagnostics)." }, "correct_answer": "2", "explanation": "إعدادات اسم الشبكة (SSID) والبث الخاص بها هي جزء أساسي من تكوين الشبكة اللاسلكية، وعادةً ما تكون ضمن قسم إعدادات الشبكة أو إعدادات الواي فاي." },
             { "id": 273, "question": "ماذا يعني أن تكون باقة الإنترنت في حالة 'Renew only'؟", "options": { "1": "أنه لا يمكن تجديدها إلا في يوم محدد من الشهر.", "2": "أنه يمكن للعملاء الحاليين المشتركين فيها تجديدها، ولكن لا يمكن للعملاء الجدد الاشتراك بها.", "3": "أنها باقة تتجدد تلقائيًا ولا يمكن إيقافها.", "4": "أنه لا يمكن إضافة أي باقات إضافية عليها." }, "correct_answer": "2", "explanation": "هذا الإجراء يستخدم لإيقاف الباقات القديمة تدريجيًا مع الحفاظ على العملاء الحاليين، حيث يتم منع الاشتراكات الجديدة فيها مع السماح للمشتركين القدامى بالاستمرار." },
             { "id": 274, "question": "إذا استفسر عميل عن عرض مرتبط بـ 'فيزيتا' (Vezeeta)، ما هو الإجراء الصحيح الذي يجب على الموظف اتباعه؟", "options": { "1": "إبلاغه بأن العرض خاص بالأطباء فقط.", "2": "البحث في قاعدة المعرفة عن تفاصيل العرض وكيفية الاشتراك فيه.", "3": "تحويله إلى قسم التسويق.", "4": "الطلب منه الاتصال بفيزيتا مباشرة." }, "correct_answer": "2", "explanation": "يجب على الموظف أن يكون المصدر الأول للمعلومة الصحيحة. ينبغي عليه استخدام الأدوات المتاحة للبحث عن تفاصيل وشروط العروض المشتركة لتقديم إجابة كاملة ودقيقة للعميل." },
             { "id": 275, "question": "ما هي حالة الباقة الأساسية التي تعد شرطًا ضروريًا ليتمكن العميل من استخدام سعة الباقات الإضافية؟", "options": { "1": "أن تكون على وشك الانتهاء.", "2": "أن تكون قد استُهلك نصفها على الأقل.", "3": "أن تكون نشطة (Active).", "4": "أن تكون قد تم تجديدها يدويًا." }, "correct_answer": "3", "explanation": "لا يمكن للنظام أن يسمح باستهلاك الباقات الإضافية إلا إذا كانت الخدمة الأساسية نفسها فعالة. إذا كانت الباقة الأساسية موقوفة أو منتهية، تتوقف كل الخدمات المرتبطة بها." },
             { "id": 276, "question": "ماذا يعني مصطلح 'Migration' في سياق خدمات FTTH؟", "options": { "1": "ترقية العميل من باقة ADSL إلى FTTH في نفس الشركة.", "2": "انتقال العميل بخدمة FTTH من شركة منافسة إلى شركة أخرى على نفس البنية التحتية.", "3": "تركيب خط FTTH جديد لأول مرة.", "4": "تغيير مكان خط FTTH من منزل إلى آخر." }, "correct_answer": "2", "explanation": "تُستخدم كلمة 'Migration' (الترحيل أو التحويل) لوصف عملية نقل اشتراك قائم بالفعل على بنية تحتية معينة (مثل كبائن FTTH) من مزود خدمة إلى آخر." },
             { "id": 277, "question": "عندما يقوم عميل بدفع مبلغ أكبر من قيمة الفاتورة عن طريق الخطأ، ماذا يسمى هذا الإجراء؟", "options": { "1": "شحن مقدم.", "2": "رصيد دائن أو دفعة مقدمة (Credit Balance).", "3": "تبرع للشركة.", "4": "غرامة تأخير." }, "correct_answer": "2", "explanation": "المبلغ الزائد عن قيمة الفاتورة المستحقة يتم تسجيله في حساب العميل كرصيد دائن، ويتم استخدامه تلقائيًا لتغطية جزء من الفاتورة التالية أو أي رسوم مستقبلية." },
             { "id": 278, "question": "في أي مرحلة من عمر الخط لا يمكن إضافة خدمة 'سلفني' الطارئة لها؟", "options": { "1": "مرحلة الإيقاف المؤقت (Suspended).", "2": "مرحلة النشاط (Active).", "3": "مرحلة الإيقاف النهائي (Suspended Lifecycle / Deactivated).", "4": "فترة السماح بعد انتهاء الباقة." }, "correct_answer": "3", "explanation": "الخطوط التي دخلت مرحلة الإيقاف النهائي تكون قد خرجت من الخدمة الفعلية وتتطلب إجراءات إعادة تفعيل كاملة، ولا تكون مؤهلة للخدمات المؤقتة مثل 'سلفني'." },
             { "id": 279, "question": "إذا طلب العميل الحصول على فاتورة إلكترونية لفترة تتجاوز 90 يومًا، ما هو الإجراء المتبع عادةً؟", "options": { "1": "يتم رفض الطلب تلقائيًا.", "2": "يتم توفيرها فورًا عبر التطبيق.", "3": "يتم إنشاء طلب خاص (SR) لهذه الحالة، وقد يتطلب إجراءات إضافية.", "4": "يجب على العميل زيارة الفرع لاستلامها." }, "correct_answer": "3", "explanation": "الأنظمة عادة ما تحتفظ بالفواتير الحديثة بشكل متاح بسهولة. الوصول إلى الفواتير القديمة جدًا قد يتطلب بحثًا في الأرشيف، لذا يتم التعامل معها كطلب خاص له إجراءاته ومدته الزمنية." },
             { "id": 280, "question": "ما هو الهدف من عملية الـ 'Call Back' للعميل بعد انقطاع المكالمة؟", "options": { "1": "التأكد من أن رقم العميل يعمل.", "2": "استكمال الخدمة التي كان يطلبها العميل وتقديم تجربة خدمة متكاملة.", "3": "عرض منتجات جديدة على العميل.", "4": "تحديث بيانات العميل في النظام." }, "correct_answer": "2", "explanation": "إعادة الاتصال بالعميل هي ممارسة احترافية تهدف إلى تقليل جهد العميل ومنعه من الاضطرار إلى إعادة شرح مشكلته من البداية، مما يعزز رضاه عن الخدمة." },
             { "id": 281, "question": "لأي غرض يتم إنشاء 'Work Order' (أمر عمل)؟", "options": { "1": "لتوثيق محادثة مع العميل.", "2": "لإرسال مهمة لفريق ميداني، مثل فني التركيبات أو الصيانة.", "3": "لتغيير باقة العميل.", "4": "لتسجيل شكوى بخصوص الفاتورة." }, "correct_answer": "2", "explanation": "أمر العمل هو الأداة الرسمية المستخدمة في أنظمة CRM لإسناد ومتابعة المهام التي تتطلب تحركًا فعليًا خارج مركز الاتصال، مثل الزيارات الفنية." },
             { "id": 282, "question": "إذا كان العميل مشتركًا في باقة ألعاب (GAMERZ)، وقام بمشاهدة بث مباشر (Streaming) على منصة مثل Twitch أو YouTube، كيف يتم حساب استهلاكه؟", "options": { "1": "يتم خصمه من باقة الألعاب (الجيجا بنصف جيجا).", "2": "لا يتم خصمه على الإطلاق.", "3": "يتم خصمه من الباقة الأساسية (الجيجا بجيجا).", "4": "يتم خصم نصف الاستهلاك من باقة الألعاب والنصف الآخر من الأساسية." }, "correct_answer": "3", "explanation": "باقات الألعاب مخصصة لاستهلاك بيانات اللعب الفعلي (In-game data). أما مشاهدة البثوث أو تصفح المواقع المتعلقة بالألعاب فيعتبر استخدامًا عامًا للإنترنت ويُخصم من الباقة الأساسية." },
             { "id": 283, "question": "عندما يواجه العميل مشكلة فنية، ما هي أولى خطوات استكشاف الأخطاء وإصلاحها (Troubleshooting) التي يُنصح بها دائمًا؟", "options": { "1": "إعادة ضبط المصنع للراوتر.", "2": "تحديث نظام تشغيل الكمبيوتر.", "3": "إعادة تشغيل الراوتر والأجهزة المتصلة به.", "4": "تغيير كابلات التوصيل." }, "correct_answer": "3", "explanation": "إعادة التشغيل هي خطوة بسيطة لكنها فعالة للغاية في حل العديد من المشاكل المؤقتة المتعلقة بالبرامج أو الاتصال عن طريق مسح الذاكرة المؤقتة وتحديث الاتصال بالشبكة." },
             { "id": 284, "question": "ماذا يعني وجود خطأ 'Wrong Card and Port' في نظام الدعم الفني؟", "options": { "1": "أن بطاقة العميل الائتمانية مرفوضة.", "2": "أن بيانات خط العميل مسجلة على منفذ (Port) مادي خاطئ في الكبينة أو السنترال.", "3": "أن العميل أدخل كلمة سر خاطئة.", "4": "أن كارت الشبكة في جهاز الكمبيوتر معطل." }, "correct_answer": "2", "explanation": "هذا الخطأ فني بحت ويتعلق بالبنية التحتية للشبكة، حيث لا يتطابق المنفذ الفعلي الموصول به خط العميل مع البيانات المسجلة على النظام، مما يسبب انقطاع الخدمة ويتطلب تدخلاً من فني." },
             { "id": 285, "question": "إذا لم يتمكن الموظف من حل مشكلة العميل على الفور، ما هو التصرف الأمثل؟", "options": { "1": "إنهاء المكالمة والطلب من العميل الاتصال لاحقًا.", "2": "تصعيد المشكلة إلى المستوى الأعلى من الدعم الفني أو القسم المختص مع إعطاء العميل رقمًا مرجعيًا للشكوى.", "3": "نصح العميل بالذهاب إلى أقرب فرع.", "4": "تخمين حل وإعطائه للعميل." }, "correct_answer": "2", "explanation": "الاعتراف بحدود المعرفة وتصعيد المشكلة بشكل منظم هو الإجراء الصحيح. إعطاء رقم مرجعي للعميل يطمئنه بأن مشكلته قيد المتابعة ويسهل عليه الاستعلام عنها لاحقًا." },
             { "id": 286, "question": "ما هو الهدف من 'عروض الاستحواذ' (Acquisition Promotions)؟", "options": { "1": "زيادة ولاء العملاء الحاليين.", "2": "تشجيع العملاء على استخدام التطبيق.", "3": "جذب عملاء جدد للاشتراك في الخدمة لأول مرة.", "4": "تقليل عدد العملاء الذين يلغون اشتراكهم." }, "correct_answer": "3", "explanation": "تُصمم هذه العروض خصيصًا لجعل الاشتراك الأولي أكثر جاذبية للمستخدمين الجدد، وذلك من خلال تقديم مزايا مثل أسعار مخفضة أو سعات إضافية لفترة محدودة." },
             { "id": 287, "question": "لماذا لا يُنصح بإعطاء كلمة سر الواي فاي (Wi-Fi Password) لأي شخص؟", "options": { "1": "لأن ذلك يبطئ سرعة الإنترنت.", "2": "لأنه يسمح للآخرين باستهلاك سعة الباقة الخاصة بك وقد يعرض أجهزتك وبياناتك للخطر.", "3": "لأنه قد يتسبب في تلف الراوتر.", "4": "لأنه مخالف لشروط العقد مع الشركة." }, "correct_answer": "2", "explanation": "السماح لأجهزة غير موثوقة بالاتصال بشبكتك لا يستهلك الباقة فقط، بل قد يفتح الباب أمام البرامج الضارة والفيروسات للوصول إلى أجهزتك الشخصية المتصلة بنفس الشبكة." },
             { "id": 288, "question": "إذا قام العميل بتغيير باقته إلى باقة أعلى في منتصف الشهر، كيف يتم حساب الفاتورة عادةً؟", "options": { "1": "يدفع قيمة الباقة الجديدة كاملة بالإضافة إلى القديمة.", "2": "لا يدفع أي شيء حتى الشهر التالي.", "3": "يتم حساب التكلفة بشكل نسبي (Prorated)، حيث يدفع الفرق عن الأيام المتبقية في الشهر.", "4": "يحصل على ترقية مجانية حتى نهاية الشهر." }, "correct_answer": "3", "explanation": "المحاسبة النسبية هي الطريقة العادلة لحساب التكاليف عند حدوث تغيير في الخدمة. يتم حساب تكلفة الأيام التي استُخدمت فيها الباقة القديمة وتكلفة الأيام المتبقية على الباقة الجديدة." },
             { "id": 289, "question": "أي من الإجراءات التالية لا يمكن للعميل القيام به من خلال تطبيقات الخدمة الذاتية (Self-Service Apps)؟", "options": { "1": "تجديد الباقة.", "2": "تغيير كلمة سر الواي فاي الخاصة بالراوتر.", "3": "شراء باقات إضافية.", "4": "مراجعة استهلاك الباقة." }, "correct_answer": "2", "explanation": "تطبيقات الخدمة الذاتية مخصصة لإدارة الحساب والاشتراكات. أما إعدادات جهاز الراوتر نفسه (مثل كلمة سر الواي فاي) فيجب تغييرها عن طريق الدخول المباشر لصفحة إعدادات الراوتر." },
             { "id": 290, "question": "ما هو الإجراء القياسي إذا طلب عميل تفعيل خدمة FTTH في منطقة لا تدعمها حالياً؟", "options": { "1": "أخذ بياناته في قائمة انتظار وإبلاغه بأنه سيتم التواصل معه عند توفر الخدمة.", "2": "إقناعه بالاشتراك في خدمة ADSL بدلاً منها.", "3": "رفض الطلب وإنهاء المكالمة.", "4": "تحويله إلى قسم الشكاوى." }, "correct_answer": "1", "explanation": "هذا الإجراء يظهر اهتمامًا بالعميل ويساعد الشركة في قياس الطلب على الخدمة في المناطق المختلفة لتوجيه خطط التوسع المستقبلية." },
             { "id": 291, "question": "إذا كان خط العميل يدعم سرعات عالية، ولكنه يشتكي من بطء شديد، وأظهر الفحص أن المشكلة ليست من الشبكة، فما هو الاحتمال الأكبر لسبب المشكلة؟", "options": { "1": "مشكلة في جهاز الراوتر الخاص بالعميل أو فيروسات على أجهزته.", "2": "بعد المسافة عن السنترال.", "3": "ضغط على الشبكة في المنطقة.", "4": "سياسة الاستخدام العادل." }, "correct_answer": "1", "explanation": "عندما تكون الشبكة سليمة، فإن أغلب أسباب البطء تكون محلية لدى العميل، مثل قدم طراز الراوتر، أو وجود برامج ضارة تستهلك موارد الشبكة، أو وجود عدد كبير جداً من الأجهزة المتصلة." },
             { "id": 292, "question": "ما هي الفائدة الأساسية من استخدام تردد 5GHz في الواي فاي بدلاً من 2.4GHz؟", "options": { "1": "مدى تغطية أوسع بكثير.", "2": "سرعة أعلى وتداخل أقل من الشبكات والأجهزة المجاورة.", "3": "استهلاك أقل لطاقة الراوتر.", "4": "توافق مع جميع الأجهزة القديمة والحديثة." }, "correct_answer": "2", "explanation": "يوفر تردد 5GHz قنوات اتصال أكثر وأوسع، وهو أقل ازدحامًا من تردد 2.4GHz الذي تستخدمه العديد من الأجهزة المنزلية، مما ينتج عنه اتصال أكثر سرعة واستقرارًا، خاصة في المناطق المكتظة بالسكان." },
             { "id": 293, "question": "في حال فشل عملية دفع عبر Apple Pay، ما هي أول جهة يجب على العميل التواصل معها للتحقق من المشكلة؟", "options": { "1": "شركة الاتصالات.", "2": "شركة أبل.", "3": "البنك الذي أصدر البطاقة المربوطة بالخدمة.", "4": "الدعم الفني للإنترنت." }, "correct_answer": "3", "explanation": "Apple Pay هو مجرد وسيط. سبب فشل الدفع غالبًا ما يكون مرتبطًا بالبطاقة نفسها، مثل عدم وجود رصيد كافٍ، أو تجاوز الحد الائتماني، أو قيود فرضها البنك على المعاملات عبر الإنترنت." },
             { "id": 294, "question": "ما هو الإجراء الصحيح الذي يجب على الموظف اتخاذه عند تلقي مكالمة صامتة (Silent Call)؟", "options": { "1": "إغلاق الخط مباشرة.", "2": "محاولة مخاطبة العميل عدة مرات ثم إنهاء المكالمة إذا لم يكن هناك رد.", "3": "تحويل المكالمة إلى مشرف الفريق.", "4": "الانتظار على الخط لمدة 5 دقائق." }, "correct_answer": "2", "explanation": "الإجراء القياسي هو محاولة التأكد من وجود مشكلة فنية في الاتصال من خلال مخاطبة العميل بوضوح. إذا استمر الصمت، يتم إنهاء المكالمة لإتاحة الخط لعملاء آخرين." },
             { "id": 295, "question": "عندما يقوم العميل بطلب 'تجديد مبكر' لباقته، ماذا يحدث للسعة المتبقية من الباقة القديمة؟", "options": { "1": "تضاف إلى سعة الباقة الجديدة.", "2": "يتم ترحيلها للشهر التالي.", "3": "يفقدها العميل، حيث تبدأ دورة جديدة بسعة جديدة.", "4": "يتم تعويضه بقيمة مالية عنها." }, "correct_answer": "3", "explanation": "التجديد المبكر يعني إنهاء الدورة الحالية وبدء دورة جديدة تمامًا. لا يتم ترحيل أي سعة متبقية من الدورة القديمة، ويحصل العميل على كامل سعة الباقة الجديدة لمدة 30 يومًا من تاريخ التجديد." },
             { "id": 296, "question": "ما الهدف من 'عروض الاحتفاظ بالعملاء' (Retention Concessions)؟", "options": { "1": "مكافأة العملاء الجدد.", "2": "بيع خدمات إضافية للعملاء الحاليين.", "3": "تقديم حوافز للعملاء الذين ينوون إلغاء اشتراكهم لإقناعهم بالبقاء.", "4": "الإعلان عن منتجات جديدة." }, "correct_answer": "3", "explanation": "هذه العروض هي أداة استباقية للحفاظ على قاعدة العملاء، حيث يتم تقديم خصومات أو مزايا خاصة للعميل الذي يبدي رغبة واضحة في إنهاء علاقته بالشركة." },
             { "id": 297, "question": "ما هي أفضل طريقة للرد على عميل يستفسر عن عرض ترويجي قديم ومنتهي؟", "options": { "1": "إخباره بوضوح أن العرض لم يعد متاحًا وتوجيهه لمعرفة العروض الحالية.", "2": "محاولة تفعيل العرض له بشكل استثنائي.", "3": "إخباره بأن عليه الانتظار حتى يعود العرض مرة أخرى.", "4": "تجاهل سؤاله وتغيير موضوع المحادثة." }, "correct_answer": "1", "explanation": "الشفافية والمصداقية هما أساس بناء الثقة. يجب إعلام العميل بالوضع الحالي بدقة وتقديم بدائل متاحة له من خلال القنوات الرسمية." },
             { "id": 298, "question": "لماذا يعتبر توفير رقم هاتف أرضي صحيحًا أمرًا حيويًا عند الاشتراك في خدمة الإنترنت ADSL؟", "options": { "1": "لأنه يستخدم لإرسال الفواتير الورقية.", "2": "لأن خدمة الإنترنت ADSL يتم توصيلها وتشغيلها عبر نفس الخط النحاسي للهاتف الأرضي.", "3": "لأنه يستخدم للتحقق من هوية العميل فقط.", "4": "لأنه شرط قانوني فقط وليس له استخدام فني." }, "correct_answer": "2", "explanation": "تعتمد تقنية ADSL بشكل كامل على البنية التحتية للخطوط الهاتفية النحاسية. لا يمكن تقديم الخدمة بدون وجود خط أرضي فعال يتم تركيب الخدمة عليه." },
             { "id": 369, "question": "إذا قام العميل بطلب خدمة 'سلفني' ثم قام بشحن رصيد لتجديد باقته الأساسية، كيف يتم محاسبته؟", "options": { "1": "يتم إلغاء قيمة خدمة 'سلفني' من الفاتورة.", "2": "يتم خصم قيمة خدمة 'سلفني' من الرصيد الذي قام بشحنه أولاً، ثم يتم استخدام باقي المبلغ للتجديد.", "3": "يتم تجديد الباقة أولاً، وتضاف قيمة 'سلفني' على الفاتورة التالية.", "4": "لا يمكنه التجديد إلا بعد انتهاء سعة 'سلفني'." }, "correct_answer": "2", "explanation": "خدمة 'سلفني' هي دين على الحساب. عند توفر رصيد، تكون الأولوية لتسوية الديون المستحقة أولاً قبل استخدام الرصيد في أي خدمات جديدة." },
             { "id": 370, "question": "ما هو الإجراء الذي يجب على الموظف فعله إذا كان العميل يستفسر عن كومباوند 'ERK' ويريد الاشتراك في خدمة الفايبر (FTTH)؟", "options": { "1": "إبلاغه بأن الإجراءات عادية مثل أي مكان آخر.", "2": "تحويله إلى الفريق المختص بخدمات FTTH أو إبلاغه بوجود نقطة بيع خاصة داخل الكومباوند.", "3": "إنشاء طلب خدمة ADSL له مؤقتًا.", "4": "الطلب منه تقديم طلب عبر الموقع الإلكتروني فقط." }, "correct_answer": "2", "explanation": "بعض المواقع الكبيرة لها فرق مبيعات وإجراءات مخصصة. توجيه العميل مباشرة إلى القناة الصحيحة يضمن حصوله على الخدمة بشكل أسرع وأكثر كفاءة." },
             { "id": 371, "question": "ما هو كود الإغلاق الذي يستخدمه الدعم الفني عندما يتم حل مشكلة ولكن العميل يرفض إغلاق الشكوى؟", "options": { "1": "(1) تم حل المشكلة.", "2": "(2) الخط مستقر / لا توجد مشكلة.", "3": "(30) العميل غير متاح.", "4": "يتم ترك الشكوى مفتوحة." }, "correct_answer": "2", "explanation": "إذا أثبتت الاختبارات الفنية أن الخط سليم ومستقر من الناحية الفنية، يتم إغلاق الشكوى بهذا الكود ليعكس الحالة الفنية للخط، بغض النظر عن رأي العميل، مع توثيق ذلك." },
             { "id": 372, "question": "إذا كان العميل يستخدم باقة GAMERZ وقام بتنزيل لعبة من خارج منصات الألعاب المحددة (مثلاً من موقع على الإنترنت)، من أين يُخصم الاستهلاك؟", "options": { "1": "من باقة الألعاب.", "2": "من الباقة الأساسية.", "3": "لا يُخصم على الإطلاق.", "4": "يُخصم 50% من باقة الألعاب و50% من الأساسية." }, "correct_answer": "2", "explanation": "ميزة احتساب الاستهلاك المخفض في باقات الألعاب تقتصر على الألعاب المحددة ومنصاتها. أي استخدام آخر، حتى لو كان تنزيل لعبة، يُعتبر استخدامًا عاديًا للإنترنت." },
             { "id": 373, "question": "ماذا يجب على العميل فعله إذا نسى كلمة سر الدخول لصفحة إعدادات الراوتر؟", "options": { "1": "الاتصال بخدمة العملاء لطلبها.", "2": "إعادة تشغيل الراوتر.", "3": "عمل إعادة ضبط المصنع (Factory Reset) للراوتر، مما يعيد كلمة السر الافتراضية.", "4": "شراء راوتر جديد." }, "correct_answer": "3", "explanation": "إعادة ضبط المصنع هي الطريقة الوحيدة لاستعادة الوصول إلى الراوتر في حالة نسيان كلمة السر المخصصة، حيث تعود كل الإعدادات، بما في ذلك بيانات الدخول، إلى حالتها الأصلية المكتوبة على ظهر الجهاز." },
             { "id": 448, "question": "ما هو الفرق الرئيسي في البنية التحتية بين خدمة FTTH وخدمة ADSL؟", "options": { "1": "FTTH تستخدم كابلات نحاسية، بينما ADSL تستخدم ألياف بصرية.", "2": "FTTH لاسلكية بالكامل، بينما ADSL سلكية.", "3": "FTTH تستخدم كابلات الألياف البصرية حتى منزل العميل، بينما ADSL تستخدم الخطوط الهاتفية النحاسية.", "4": "لا يوجد فرق في البنية التحتية، فقط في السرعة." }, "correct_answer": "3", "explanation": "هذا هو الاختلاف الجوهري الذي يعطي تقنية FTTH ميزة السرعة الفائقة والاستقرار، حيث أن الألياف البصرية تنقل البيانات عبر الضوء وهي أقل تأثراً بالعوامل الخارجية والمسافة." },
             { "id": 449, "question": "عميل يتصل للاستفسار عن سبب عدم عمل الإنترنت، وبعد الفحص تبين أن المشكلة هي 'Wrong Card/Port'. ماذا تعني هذه المشكلة للعميل؟", "options": { "1": "أن عليه تغيير بطاقته البنكية.", "2": "أن هناك خطأ في توصيلات الكابلات الخاصة به داخل المنزل.", "3": "أن هناك خطأ في بياناته على النظام لا تتطابق مع التوصيل الفعلي في الكبينة، ويتطلب زيارة فني.", "4": "أن الراوتر الخاص به لا يدعم الخدمة." }, "correct_answer": "3", "explanation": "يجب تبسيط المعلومة الفنية للعميل. أفضل شرح هو أن هناك عدم تطابق بين الإعدادات في النظام المركزي والتوصيل المادي لخطه، وأن فنيًا سيقوم بإصلاح هذا الخلل." },
             { "id": 450, "question": "ما هي أهمية نظام CRM (إدارة علاقات العملاء) لموظف خدمة العملاء؟", "options": { "1": "هو نظام لتسجيل الحضور والانصراف.", "2": "يوفر سجلًا تاريخيًا كاملاً لتفاعلات العميل، مما يسمح بتقديم خدمة شخصية ومتسقة.", "3": "هو محرك البحث المستخدم للوصول إلى الإنترنت.", "4": "هو نظام لإرسال رسائل البريد الإلكتروني الداخلية فقط." }, "correct_answer": "2", "explanation": "يُمكّن نظام CRM الموظف من رؤية جميع طلبات العميل السابقة، وشكاويه، والملاحظات المسجلة، مما يساعده على فهم سياق المشكلة الحالية بسرعة وتقديم حل أفضل دون الحاجة لتكرار الأسئلة." }
                     ];
        
        // --- GLOBAL STATE & CONFIG ---
        let allElements = {};
        let currentUser = null;
        let currentPlayerProfile = null;
        let currentLobbyId = null;
        let unsubscribeLobby = null;
        let questionTimer = null;
        let musicPlayer = null;
        let isMuted = true;
        let singlePlayerState = {
            currentTier: null,
            currentLevel: null,
            questions: [],
            currentQuestionIndex: 0,
            answers: []
        };

        const SINGLE_PLAYER_CONFIG = {
            tiers: [
                { id: 'tier-1', name: 'مستوي الايجنت العادي', levels: 3, questionsPerLevel: 5, timePerQuestion: 30, medal: '🎖️ عادي' },
                { id: 'tier-2', name: 'مستوي الايجنت الجامد', levels: 3, questionsPerLevel: 5, timePerQuestion: 25, medal: '🎖️ جامد' },
                { id: 'tier-3', name: 'مستوي الايجنت الكوالتي', levels: 6, questionsPerLevel: 10, timePerQuestion: 20, medal: '🎖️ كوالتي' },
                { id: 'tier-4', name: 'مستوي الايجنت السوبر فايزر', levels: 6, questionsPerLevel: 20, timePerQuestion: 15, medal: '🎖️ سوبرفايزر' },
                { id: 'tier-5', name: 'مستوي الايجنت البطرس', levels: 6, questionsPerLevel: 40, timePerQuestion: 10, medal: '🎖️ بطرس' },
            ]
        };
        
        // --- CORE UI FUNCTIONS ---
        function showScreen(screenId) {
            document.querySelectorAll('.screen-container').forEach(s => s.classList.remove('active'));
            const screen = document.getElementById(screenId);
            if (screen) screen.classList.add('active');
        }

        function showAlert(title, message) {
            allElements.modalTitle.textContent = title;
            allElements.modalBody.textContent = message;
            allElements.modal.classList.add('visible');
        }

        function mapElements() {
            allElements = {};
            document.querySelectorAll('[id]').forEach(el => {
                if (el.id && typeof el.id === 'string') {
                    const camelCaseId = el.id.replace(/-([a-z])/g, (_, g1) => g1.toUpperCase());
                    allElements[camelCaseId] = el;
                }
            });
        }
        
        function injectTemplates() {
            const screenIds = [
                'registration-screen', 'main-menu-screen', 'online-menu-screen', 'join-lobby-screen',
                'online-lobby-screen', 'leaderboard-screen', 'awards-screen', 'match-screen',
                'game-over-screen', 'modal', 'single-player-menu-screen', 'level-select-screen'
            ];
            screenIds.forEach(id => {
                const container = document.getElementById(id);
                const template = document.getElementById(`${id}-template`);
                if (container && template) container.innerHTML = template.innerHTML;
            });
        }

        function toggleMusic() {
            if (!musicPlayer) {
                musicPlayer = new Audio('https://v15mbanna3.github.io/my-sounds/Gna7%20felsama.mp3');
                musicPlayer.loop = true;
            }
            isMuted = !isMuted;
            if (isMuted) {
                musicPlayer.pause();
                allElements.muteBtn.textContent = '🔇';
            } else {
                musicPlayer.play().catch(() => { isMuted = true; allElements.muteBtn.textContent = '🔇'; });
                allElements.muteBtn.textContent = '🔊';
            }
        }
        
        // --- AUTH & PROFILE ---
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                currentUser = user;
                const teleoptiId = localStorage.getItem('triviaTeleoptiId');
                if (teleoptiId) {
                    await loadPlayerProfile(teleoptiId);
                    updateMainMenu();
                    showScreen('main-menu-screen');
                } else {
                    showScreen('registration-screen');
                }
            } else {
                const teleoptiId = localStorage.getItem('triviaTeleoptiId');
                if (teleoptiId) {
                    const name = localStorage.getItem('triviaName');
                    setTimeout(() => {
                        if(allElements.nameInput) allElements.nameInput.value = name || '';
                        if(allElements.teleoptiIdInput) allElements.teleoptiIdInput.value = teleoptiId || '';
                    }, 0);
                    showScreen('registration-screen');
                } else {
                    showScreen('registration-screen');
                }
            }
            if (allElements.loadingScreen) {
                allElements.loadingScreen.classList.remove('active');
            }
        });
        
        async function handleLogin() {
            const name = allElements.nameInput.value.trim();
            const teleoptiId = allElements.teleoptiIdInput.value.trim();
            const rememberMe = allElements.rememberMeCheckbox.checked;

            if (!name || !teleoptiId) return showAlert("خطأ", "الرجاء إدخال الاسم و Teleopti ID.");
            if (!/^\d+$/.test(teleoptiId)) return showAlert("خطأ", "Teleopti ID يجب أن يحتوي على أرقام فقط.");

            try {
                if (!auth.currentUser) await signInAnonymously(auth);
                currentUser = auth.currentUser;
                
                const playerRef = doc(db, "players", teleoptiId);
                const playerDoc = await getDoc(playerRef);

                if (playerDoc.exists()) {
                    currentPlayerProfile = { ...playerDoc.data(), teleoptiId };
                    if(currentPlayerProfile.name !== name || currentPlayerProfile.uid !== currentUser.uid) {
                        await setDoc(playerRef, { name, uid: currentUser.uid }, { merge: true });
                        currentPlayerProfile.name = name;
                        currentPlayerProfile.uid = currentUser.uid;
                    }
                } else {
                    currentPlayerProfile = { name, teleoptiId, uid: currentUser.uid, score: 0, awards: [], singlePlayerProgress: {} };
                    await setDoc(playerRef, currentPlayerProfile);
                }

                if (rememberMe) {
                    localStorage.setItem('triviaTeleoptiId', teleoptiId);
                    localStorage.setItem('triviaName', name);
                } else {
                    localStorage.removeItem('triviaTeleoptiId');
                    localStorage.removeItem('triviaName');
                }
                
                if (!currentPlayerProfile.singlePlayerProgress) currentPlayerProfile.singlePlayerProgress = {};

                updateMainMenu();
                showScreen('main-menu-screen');

                const urlParams = new URLSearchParams(window.location.search);
                const lobbyToJoin = urlParams.get('lobby');
                if (lobbyToJoin && currentPlayerProfile) {
                    history.replaceState(null, '', window.location.pathname); 
                    joinLobby(lobbyToJoin, true);
                }

            } catch (error) {
                console.error("Login failed:", error);
                showAlert("فشل تسجيل الدخول", "حدث خطأ ما. يرجى التأكد من اتصالك بالإنترنت والمحاولة مرة أخرى.");
            }
        }
        
        async function loadPlayerProfile(teleoptiId) {
             const playerRef = doc(db, "players", teleoptiId);
             const playerDoc = await getDoc(playerRef);
             if (playerDoc.exists()) {
                 currentPlayerProfile = { ...playerDoc.data(), teleoptiId };
                 if (!currentPlayerProfile.singlePlayerProgress) currentPlayerProfile.singlePlayerProgress = {};
             } else {
                 handleLogout();
             }
        }

        async function handleLogout() {
            try {
                if (auth.currentUser) await signOut(auth);
            } catch (error) {
                console.error("Logout failed:", error);
            } finally {
                currentUser = null;
                currentPlayerProfile = null;
                localStorage.clear();
                if(allElements.nameInput) allElements.nameInput.value = '';
                if(allElements.teleoptiIdInput) allElements.teleoptiIdInput.value = '';
                showScreen('registration-screen');
            }
        }
        
        // --- UI UPDATES ---
        function updateMainMenu() {
            if (!currentPlayerProfile) return;
            allElements.welcomeMessage.innerHTML = `أهلاً بك, <span class="name">${currentPlayerProfile.name}</span> <span class="teleopti-id-display">(${currentPlayerProfile.teleoptiId})</span>`;
            const awards = (currentPlayerProfile.awards || []).join(' ');
            allElements.medalsDisplay.textContent = awards;
        }

        function populateLeaderboard(players) {
            allElements.leaderboardList.innerHTML = '';
            players.forEach((player, index) => {
                const item = document.createElement('div');
                item.className = 'list-item';
                if(index === 0) item.style.borderColor = 'gold';
                if(index === 1) item.style.borderColor = 'silver';
                if(index === 2) item.style.borderColor = '#cd7f32';
                const highestMedal = getHighestMedal(player);
                const medalDisplay = highestMedal ? ` ${highestMedal}` : '';
                item.innerHTML = `<div><span class="item-rank">${index + 1}</span><span class="item-name">${player.name}${medalDisplay} <span class="teleopti-id-display">(${player.teleoptiId})</span></span></div><span class="item-value">${player.score || 0} نقطة</span>`;
                allElements.leaderboardList.appendChild(item);
            });
        }
        
        // --- GAME LOGIC & HELPERS ---
        function getQuestionsForLevel(count) {
            if (QUESTION_BANK.length === 0) return [];
            const shuffled = [...QUESTION_BANK].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, Math.min(count, QUESTION_BANK.length));
        }

        function getHighestMedal(playerProfile) {
            if (!playerProfile || !playerProfile.awards || !Array.isArray(playerProfile.awards)) return '';
            const allMedalsInOrder = SINGLE_PLAYER_CONFIG.tiers.map(t => t.medal).reverse(); 
            for (const medal of allMedalsInOrder) {
                if (playerProfile.awards.includes(medal)) {
                    return medal;
                }
            }
            return '';
        }

        // --- SINGLE PLAYER LOGIC ---
        function displayTiers() {
            const grid = allElements.tiersGrid;
            grid.innerHTML = '';
            let lastTierCompleted = true;
            SINGLE_PLAYER_CONFIG.tiers.forEach((tier, index) => {
                const completedLevels = currentPlayerProfile.singlePlayerProgress?.[tier.id]?.length || 0;
                const isLocked = index > 0 && !lastTierCompleted;
                const progressPercent = (completedLevels / tier.levels) * 100;

                const card = document.createElement('div');
                card.className = `card ${isLocked ? 'locked' : ''}`;
                card.innerHTML = `
                    <h3 class="card-title">${isLocked ? '🔒 ' : ''}${tier.name}</h3>
                    <p class="card-details">المستويات: ${tier.levels} | الأسئلة لكل مستوى: ${tier.questionsPerLevel}</p>
                    <p class="card-details">الوقت للسؤال: ${tier.timePerQuestion} ثانية</p>
                    <div class="progress-bar-container"><div class="progress-bar" style="width: ${progressPercent}%"></div></div>`;
                if (!isLocked) card.onclick = () => displayLevels(tier);
                grid.appendChild(card);
                
                if (progressPercent < 100) lastTierCompleted = false;
            });
            showScreen('single-player-menu-screen');
        }

        function displayLevels(tier) {
            singlePlayerState.currentTier = tier;
            allElements.levelSelectTitle.textContent = tier.name;
            const grid = allElements.levelsGrid;
            grid.innerHTML = '';
            const completedInTier = currentPlayerProfile.singlePlayerProgress?.[tier.id] || [];

            for (let i = 0; i < tier.levels; i++) {
                const isCompleted = completedInTier.includes(i);
                const card = document.createElement('div');
                card.className = `card level-card ${isCompleted ? 'completed' : ''}`;
                card.innerHTML = `<h3 class="card-title">المستوى ${i + 1}</h3> ${isCompleted ? '<p class="card-details">✅ مكتمل</p>' : ''}`;
                card.onclick = () => startSinglePlayerLevel(tier, i);
                grid.appendChild(card);
            }
            showScreen('level-select-screen');
        }

        function startSinglePlayerLevel(tier, levelIndex) {
            singlePlayerState = { currentTier: tier, currentLevel: levelIndex, questions: getQuestionsForLevel(tier.questionsPerLevel), currentQuestionIndex: 0, answers: [] };
            displaySinglePlayerQuestion();
        }
        
        function displaySinglePlayerQuestion() {
            showScreen('match-screen');
            const { currentTier, currentQuestionIndex, questions } = singlePlayerState;
            const question = questions[currentQuestionIndex];

            allElements.matchHeader.textContent = `${currentTier.name} - المستوى ${singlePlayerState.currentLevel + 1}`;
            allElements.questionCounter.textContent = `السؤال ${currentQuestionIndex + 1} / ${questions.length}`;
            allElements.questionText.innerHTML = question.question || "السؤال غير متوفر"; 
            allElements.explanationBox.classList.remove('visible');
            if (allElements.surrenderBtn) allElements.surrenderBtn.style.display = 'none';
            if (allElements.matchBackBtn) allElements.matchBackBtn.style.display = 'inline-block';

            allElements.optionsGrid.innerHTML = '';
            const optionsArray = Object.values(question.options);
            optionsArray.forEach((option, i) => {
                const btn = document.createElement('button');
                btn.className = 'btn btn-secondary option-btn';
                btn.textContent = option;
                btn.onclick = () => handleSinglePlayerAnswer(i);
                allElements.optionsGrid.appendChild(btn);
            });
            
            const timeLimit = currentTier.timePerQuestion * 1000;
            requestAnimationFrame(() => {
                allElements.timerBar.style.transition = 'none';
                allElements.timerBar.style.width = '100%';
                setTimeout(() => {
                    allElements.timerBar.style.transition = `width ${timeLimit / 1000}s linear`;
                    allElements.timerBar.style.width = '0%';
                }, 50);
            });
            
            clearTimeout(questionTimer);
            questionTimer = setTimeout(() => handleSinglePlayerAnswer(null), timeLimit);
        }

        function handleSinglePlayerAnswer(selectedIndex) {
            clearTimeout(questionTimer);
            const { questions, currentQuestionIndex } = singlePlayerState;
            const question = questions[currentQuestionIndex];
            
            const optionsArray = Object.values(question.options);
            const correctAnswerValue = question.options[question.correct_answer];
            const correctAnswerIndex = optionsArray.indexOf(correctAnswerValue);
            
            const isCorrect = selectedIndex === correctAnswerIndex;
            singlePlayerState.answers.push(isCorrect);

            document.querySelectorAll('.option-btn').forEach((btn, i) => {
                btn.classList.add('disabled');
                btn.onclick = null;
                if (i === correctAnswerIndex) {
                    btn.classList.add('correct');
                    btn.innerHTML += ' ✅';
                }
            });
            
            let nextQuestionDelay = 3000;

            if (!isCorrect) {
                if (selectedIndex !== null) {
                    const wrongBtn = document.querySelectorAll('.option-btn')[selectedIndex];
                    if (wrongBtn) {
                        wrongBtn.classList.add('wrong');
                        wrongBtn.innerHTML += ' ❌';
                    }
                }
                if (question.explanation) {
                    allElements.explanationBox.textContent = `التفسير: ${question.explanation}`;
                    allElements.explanationBox.classList.add('visible');
                    nextQuestionDelay = 5000;
                }
            }

            setTimeout(() => {
                if (currentQuestionIndex < questions.length - 1) {
                    singlePlayerState.currentQuestionIndex++;
                    displaySinglePlayerQuestion();
                } else {
                    finishSinglePlayerLevel();
                }
            }, nextQuestionDelay);
        }

        async function finishSinglePlayerLevel() {
            const allCorrect = singlePlayerState.answers.every(a => a === true);
            if (!allCorrect) {
                showAlert("المحاولة مرة أخرى", "لم تتمكن من الإجابة على جميع الأسئلة بشكل صحيح. حاول مرة أخرى!");
                return displayLevels(singlePlayerState.currentTier);
            }

            const { id: tierId, medal } = singlePlayerState.currentTier;
            const levelIndex = singlePlayerState.currentLevel;
            const playerRef = doc(db, "players", currentPlayerProfile.teleoptiId);

            if (!currentPlayerProfile.singlePlayerProgress[tierId]?.includes(levelIndex)) {
                await updateDoc(playerRef, { 
                    score: increment(10),
                    [`singlePlayerProgress.${tierId}`]: arrayUnion(levelIndex) 
                });
                
                if (!currentPlayerProfile.singlePlayerProgress[tierId]) currentPlayerProfile.singlePlayerProgress[tierId] = [];
                currentPlayerProfile.singlePlayerProgress[tierId].push(levelIndex);
                if (!currentPlayerProfile.score) currentPlayerProfile.score = 0;
                currentPlayerProfile.score += 10;
            }

            showAlert("مستوى مكتمل!", "أحسنت! لقد أكملت هذا المستوى بنجاح وحصلت على 10 نقاط.");
            
            const completedInTier = currentPlayerProfile.singlePlayerProgress[tierId] || [];
            if (completedInTier.length === singlePlayerState.currentTier.levels) {
                if (!currentPlayerProfile.awards.includes(medal)) {
                    await updateDoc(playerRef, { 
                        awards: arrayUnion(medal),
                        score: increment(30)
                    });
                    currentPlayerProfile.awards.push(medal);
                    currentPlayerProfile.score += 30;
                    showAlert("مستوى مكتمل!", `لقد أكملت ${singlePlayerState.currentTier.name} وحصلت على ${medal} و 30 نقطة إضافية!`);
                    updateMainMenu();
                }
            }
            displayTiers();
        }
        
        // --- ONLINE MULTIPLAYER LOGIC ---
        async function createLobby(type) {
            if (!currentUser || !currentPlayerProfile) return showAlert("خطأ", "يجب تسجيل الدخول أولاً.");
            const lobbyCode = Math.random().toString(36).substring(2, 6).toUpperCase();
            const lobbyRef = doc(db, "lobbies", lobbyCode);
            
            const highestMedal = getHighestMedal(currentPlayerProfile);
            const newLobby = {
                lobbyCode, type, hostUid: currentUser.uid, createdAt: serverTimestamp(),
                status: "waiting",
                players: [{ uid: currentUser.uid, name: currentPlayerProfile.name, teleoptiId: currentPlayerProfile.teleoptiId, score: 0, medal: highestMedal }],
                currentQuestionIndex: -1, answers: {}
            };
            await setDoc(lobbyRef, newLobby);
            joinLobby(lobbyCode);
        }

        function joinLobby(code) {
            if (!currentUser || !currentPlayerProfile) return showAlert("خطأ", "يجب تسجيل الدخول أولاً للانضمام.");
            const lobbyCode = code.toUpperCase();
            const lobbyRef = doc(db, "lobbies", lobbyCode);
            
            if (unsubscribeLobby) unsubscribeLobby();

            unsubscribeLobby = onSnapshot(lobbyRef, async (docSnap) => {
                if (!docSnap.exists()) {
                    showAlert("خطأ", "الغرفة غير موجودة أو تم إغلاقها.");
                    if(unsubscribeLobby) unsubscribeLobby();
                    unsubscribeLobby = null;
                    return showScreen('online-menu-screen');
                }

                const lobbyData = docSnap.data();
                const playerInLobby = lobbyData.players.find(p => p.uid === currentUser.uid);

                if (lobbyData.status !== 'waiting' && !playerInLobby) {
                    showAlert("مغلق", "هذه المنافسة قد بدأت بالفعل أو انتهت.");
                    if(unsubscribeLobby) unsubscribeLobby();
                    return showScreen('online-menu-screen');
                }
                
                if(lobbyData.type === '1v1' && lobbyData.players.length >= 2 && !playerInLobby) {
                    showAlert("ممتلئة", "هذه المواجهة ممتلئة بالفعل.");
                     if(unsubscribeLobby) unsubscribeLobby();
                    return showScreen('online-menu-screen');
                }
                
                if (!playerInLobby) {
                    const highestMedal = getHighestMedal(currentPlayerProfile);
                    await updateDoc(lobbyRef, {
                        players: arrayUnion({ uid: currentUser.uid, name: currentPlayerProfile.name, teleoptiId: currentPlayerProfile.teleoptiId, score: 0, medal: highestMedal })
                    });
                } else {
                    switch (lobbyData.status) {
                        case 'waiting': case 'countdown': updateLobbyScreen(lobbyData); showScreen('online-lobby-screen'); break;
                        case 'in-progress': runGame(lobbyData); break;
                        case 'finished': displayGameOver(lobbyData); break;
                    }
                }
            }, (error) => {
                console.error("Lobby snapshot error:", error);
                showAlert("خطأ بالاتصال", "فقد الاتصال بغرفة اللعب.");
                leaveLobby();
            });
        }
        
        function updateLobbyScreen(lobbyData) {
            if (!lobbyData || !currentUser) return;
            currentLobbyId = lobbyData.lobbyCode;
            const isHost = lobbyData.hostUid === currentUser.uid;
            
            allElements.lobbyTitle.textContent = lobbyData.type === '1v1' ? 'ردهة المواجهة (1 ضد 1)' : 'ردهة المنافسة الحاشدة';
            allElements.lobbyCodeDisplay.textContent = lobbyData.lobbyCode;
            
            allElements.lobbyPlayersList.innerHTML = '';
            lobbyData.players.forEach(player => {
                const item = document.createElement('div');
                item.className = 'list-item';
                const medalDisplay = player.medal ? ` ${player.medal}` : '';
                item.innerHTML = `<span class="item-name">${player.name}${medalDisplay} ${player.uid === lobbyData.hostUid ? '👑' : ''}</span>`;
                allElements.lobbyPlayersList.appendChild(item);
            });

            if (isHost) {
                allElements.startGameBtn.style.display = 'block';
                const canStart = lobbyData.type === '1v1' ? lobbyData.players.length === 2 : lobbyData.players.length >= 2;
                allElements.startGameBtn.disabled = !canStart;
            } else {
                allElements.startGameBtn.style.display = 'none';
            }
            
            if (lobbyData.status === 'countdown') {
                allElements.lobbyStatus.textContent = `المباراة ستبدأ في ${lobbyData.countdown}...`;
            } else if (lobbyData.status === 'waiting') {
                 allElements.lobbyStatus.textContent = lobbyData.type === 'massive' ? 'في انتظار لاعبين على الأقل...' : 'في انتظار اللاعب الثاني...';
            }
        }

        async function leaveLobby() {
            if (unsubscribeLobby) unsubscribeLobby();
            unsubscribeLobby = null;
            currentLobbyId = null;
            showScreen('online-menu-screen');
        }

        async function startGame() {
             if (!currentLobbyId) return;
            const lobbyRef = doc(db, "lobbies", currentLobbyId);
            
            try {
                await runTransaction(db, async (transaction) => {
                    const freshLobbyDoc = await transaction.get(lobbyRef);
                    if (!freshLobbyDoc.exists() || freshLobbyDoc.data().status !== 'waiting') {
                        throw "Lobby not in waiting state";
                    }
                    const questionCount = 30;
                    const gameQuestions = getQuestionsForLevel(questionCount);
                    transaction.update(lobbyRef, { questions: gameQuestions, status: 'countdown', countdown: 3 });
                });

                let count = 3;
                const countdownInterval = setInterval(async () => {
                    count--;
                    if (count > 0) {
                        await updateDoc(lobbyRef, { countdown: count }).catch(err => clearInterval(countdownInterval));
                    } else {
                        clearInterval(countdownInterval);
                        await updateDoc(lobbyRef, { status: 'in-progress', currentQuestionIndex: 0, questionStartTime: serverTimestamp() });
                    }
                }, 1000);

            } catch (error) {
                console.error("Failed to start game:", error);
                showAlert("خطأ", "لا يمكن بدء اللعبة. قد يكون لاعب آخر بدأها بالفعل.");
            }
        }
        
        function runGame(lobbyData) {
            if (lobbyData.status === 'finished') {
                displayGameOver(lobbyData);
                return;
            }
            if (lobbyData.status === 'in-progress' && lobbyData.currentQuestionIndex >= 0) {
                displayOnlineMatchScreen(lobbyData);
            }
        }
        
        function displayOnlineMatchScreen(lobbyData) {
            showScreen('match-screen');
            const questionIndex = lobbyData.currentQuestionIndex;
            const question = lobbyData.questions[questionIndex];
            
            if (!question) { return; }
            
            if(lobbyData.type === '1v1') {
                const player1 = lobbyData.players[0];
                const player2 = lobbyData.players[1];
                const p1Score = player1?.score || 0;
                const p2Score = player2?.score || 0;
                const p1Medal = player1?.medal ? ` ${player1.medal}` : '';
                const p2Medal = player2?.medal ? ` ${player2.medal}` : '';
                const p1Name = player1?.name || 'لاعب ١';
                const p2Name = player2?.name || 'لاعب ٢';

                allElements.matchHeader.innerHTML = `
                    <span class="name">(${p1Score}) ${p1Name}${p1Medal}</span> 
                    <span style="color: var(--accent-yellow);">ضد</span> 
                    <span class="name">${p2Name}${p2Medal} (${p2Score})</span>`;
            } else {
                allElements.matchHeader.textContent = `منافسة حاشدة - ${lobbyData.players.length} لاعبين`;
            }

            if (lobbyData.surrendered?.uid) {
                const surrenderer = lobbyData.players.find(p => p.uid === lobbyData.surrendered.uid);
                if(surrenderer) {
                    allElements.surrenderBanner.textContent = `${surrenderer.name} (${surrenderer.teleoptiId}) انهزم يا مينز!`;
                    allElements.surrenderBanner.style.display = 'block';
                }
            } else {
                allElements.surrenderBanner.style.display = 'none';
            }
            
            allElements.questionCounter.textContent = `السؤال ${questionIndex + 1} / ${lobbyData.questions.length}`;
            allElements.questionText.innerHTML = question.question || "السؤال غير متوفر";
            allElements.explanationBox.classList.remove('visible');
            if (allElements.surrenderBtn) allElements.surrenderBtn.style.display = 'inline-block';
            if (allElements.matchBackBtn) allElements.matchBackBtn.style.display = 'none';

            allElements.optionsGrid.innerHTML = '';
            const optionsArray = Object.values(question.options);
            const myAnswer = lobbyData.answers?.[questionIndex]?.[currentUser?.uid];
            const isRevealPhase = lobbyData.revealAnswerForIndex === questionIndex;

            optionsArray.forEach((option, i) => {
                const btn = document.createElement('button');
                btn.className = 'btn btn-secondary option-btn';
                btn.textContent = option;
                
                if (myAnswer || isRevealPhase) {
                    btn.classList.add('disabled');
                } else {
                    btn.onclick = () => handleOnlineAnswer(questionIndex, i);
                }
                allElements.optionsGrid.appendChild(btn);
            });
            
            if (isRevealPhase) {
                showUniversalQuestionResult(lobbyData, questionIndex);
            } else if (myAnswer) {
                revealOnlineQuestionResult(lobbyData, questionIndex);
            }
            
            const startTime = lobbyData.questionStartTime?.toMillis?.();
            if (!startTime) return;

            const questionDuration = 30000;
            const elapsed = Date.now() - startTime;
            
            clearTimeout(questionTimer);
            
            if (lobbyData.hostUid === currentUser?.uid && !isRevealPhase) {
                questionTimer = setTimeout(() => {
                    getDoc(doc(db, 'lobbies', currentLobbyId)).then(lobbyDoc => {
                        if(lobbyDoc.exists() && lobbyDoc.data().currentQuestionIndex === questionIndex) {
                            advanceOnlineQuestion();
                        }
                    });
                }, Math.max(0, questionDuration - elapsed));
            }
            
            if (isRevealPhase) {
                allElements.timerBar.style.width = '0%';
            } else {
                requestAnimationFrame(() => {
                    allElements.timerBar.style.transition = 'none';
                    allElements.timerBar.style.width = `${Math.max(0, 100 - (elapsed / questionDuration * 100))}%`;
                    setTimeout(() => {
                        allElements.timerBar.style.transition = `width ${ (questionDuration - elapsed) / 1000}s linear`;
                        allElements.timerBar.style.width = '0%';
                    }, 50);
                });
            }
        }
        
        async function handleOnlineAnswer(questionIndex, optionIndex) {
            if (!currentLobbyId || !currentUser) return;
            const lobbyRef = doc(db, "lobbies", currentLobbyId);
            const answerPath = `answers.${questionIndex}.${currentUser.uid}`;
            
            try {
                const lobbyDoc = await getDoc(lobbyRef);
                if (lobbyDoc.data()?.answers?.[questionIndex]?.[currentUser.uid]) {
                    return;
                }
                await updateDoc(lobbyRef, {
                    [answerPath]: { option: optionIndex, time: serverTimestamp() }
                });
            } catch(error) {
                console.error("Failed to submit answer:", error);
            }
        }
        
        function revealOnlineQuestionResult(lobbyData, questionIndex) {
            const question = lobbyData.questions[questionIndex];
            const myAnswerObj = lobbyData.answers?.[questionIndex]?.[currentUser.uid];
            if (!myAnswerObj) return;

            const optionsArray = Object.values(question.options);
            const correctAnswerValue = question.options[question.correct_answer];
            const correctAnswerIndex = optionsArray.indexOf(correctAnswerValue);

            document.querySelectorAll('.option-btn').forEach((btn, i) => {
                btn.classList.add('disabled');
                btn.onclick = null;
                if (i === correctAnswerIndex) {
                    btn.classList.add('correct');
                } else if (i === myAnswerObj.option) {
                    btn.classList.add('wrong');
                }
            });
            
            if (question.explanation) {
                 allElements.explanationBox.textContent = `التفسير: ${question.explanation}`;
                 allElements.explanationBox.classList.add('visible');
            }
        }
        
        function showUniversalQuestionResult(lobbyData, questionIndex) {
            const question = lobbyData.questions[questionIndex];
            if (!question) return;

            const optionsArray = Object.values(question.options);
            const correctAnswerValue = question.options[question.correct_answer];
            const correctAnswerIndex = optionsArray.indexOf(correctAnswerValue);

            document.querySelectorAll('.option-btn').forEach((btn, i) => {
                btn.classList.add('disabled');
                btn.onclick = null;
                if (i === correctAnswerIndex) {
                    btn.classList.add('correct');
                    if (!btn.innerHTML.includes('✅')) {
                        btn.innerHTML += ' ✅';
                    }
                }
            });
            
            if (question.explanation) {
                allElements.explanationBox.textContent = `التفسير: ${question.explanation}`;
                allElements.explanationBox.classList.add('visible');
            }
        }

        async function advanceOnlineQuestion() {
            if (!currentLobbyId) return;
            const lobbyRef = doc(db, "lobbies", currentLobbyId);

            await runTransaction(db, async (transaction) => {
                const lobbyDoc = await transaction.get(lobbyRef);
                if (!lobbyDoc.exists()) return;

                const lobbyData = lobbyDoc.data();
                const oldIndex = lobbyData.currentQuestionIndex;

                if (lobbyData.revealAnswerForIndex === oldIndex) {
                    return;
                }

                let playersUpdate = scoreOnlineRound(lobbyData, oldIndex);
                
                transaction.update(lobbyRef, {
                    players: playersUpdate,
                    revealAnswerForIndex: oldIndex
                });
            }).then(() => {
                setTimeout(() => {
                    getDoc(lobbyRef).then(lobbyDoc => {
                        if (!lobbyDoc.exists()) return;
                        const currentLobbyData = lobbyDoc.data();

                        if (currentLobbyData.status !== 'in-progress') return;
                        
                        const questionIndex = currentLobbyData.currentQuestionIndex;

                        if (questionIndex >= currentLobbyData.questions.length - 1) {
                            updateDoc(lobbyRef, { status: 'finished' }); 
                            finalizeOnlineGameAwards(currentLobbyData, currentLobbyData.players);
                        } else {
                            updateDoc(lobbyRef, {
                                currentQuestionIndex: questionIndex + 1,
                                questionStartTime: serverTimestamp(),
                                revealAnswerForIndex: null
                            });
                        }
                    });
                }, 5000);
            }).catch(error => {
                console.error("Transaction to advance question failed:", error);
            });
        }
        
        function scoreOnlineRound(lobbyData, questionIndex) {
            if(questionIndex < 0) return lobbyData.players;

            const question = lobbyData.questions[questionIndex];
            const answers = lobbyData.answers?.[questionIndex] || {};
            let players = JSON.parse(JSON.stringify(lobbyData.players)); 
            
            const optionsArray = Object.values(question.options);
            const correctAnswerValue = question.options[question.correct_answer];
            const correctAnswerIndex = optionsArray.indexOf(correctAnswerValue);

            let correctResponders = [];
            Object.keys(answers).forEach(uid => {
                if (answers[uid].option === correctAnswerIndex) {
                    const time = answers[uid].time?.toMillis();
                    if (time) {
                        correctResponders.push({ uid, time });
                    }
                }
            });

            correctResponders.sort((a,b) => a.time - b.time);

            if (correctResponders.length > 0) {
                const winnerUid = correctResponders[0].uid;
                const player = players.find(p => p.uid === winnerUid);
                if(player) player.score += 1;
            }
            
            return players;
        }
        
        async function finalizeOnlineGameAwards(lobbyData, finalPlayers) {
             const batch = writeBatch(db);
             const sortedPlayers = [...finalPlayers].sort((a,b) => b.score - a.score);

             if (lobbyData.type === '1v1' && sortedPlayers.length > 0) {
                 if(sortedPlayers.length < 2 || sortedPlayers[0].score > sortedPlayers[1].score) {
                     const winner = sortedPlayers[0];
                     if(winner) {
                         const winnerRef = doc(db, "players", winner.teleoptiId);
                         batch.update(winnerRef, { 
                             score: increment(30), 
                             awards: arrayUnion("Botros Race Cup 🏆") 
                         });
                     }
                 }
             } else if (lobbyData.type === 'massive') {
                 if (sortedPlayers.length > 0 && sortedPlayers[0].score > 0) {
                     const topScore = sortedPlayers[0].score;
                     const firstPlace = sortedPlayers.filter(p => p.score === topScore);
                     firstPlace.forEach(p => {
                         const playerRef = doc(db, "players", p.teleoptiId);
                         batch.update(playerRef, { score: increment(100), awards: arrayUnion("Botros Race 4 Vs 4 Golden 🥇") });
                     });
                     
                     const secondScore = sortedPlayers.find(p => p.score < topScore)?.score;
                     if (secondScore > 0) {
                         const secondPlace = sortedPlayers.filter(p => p.score === secondScore);
                         secondPlace.forEach(p => {
                             const playerRef = doc(db, "players", p.teleoptiId);
                             batch.update(playerRef, { score: increment(50), awards: arrayUnion("Botros Race 4 VS 4 Silver 🥈") });
                         });
                     }
                 }
             }
             try {
                 await batch.commit();
             } catch(error) {
                 console.error("Failed to commit final awards:", error);
             }
        }

        function displayGameOver(lobbyData) {
            if (unsubscribeLobby) unsubscribeLobby();
            unsubscribeLobby = null;
            currentLobbyId = null;

            showScreen('game-over-screen');
            const sortedPlayers = [...lobbyData.players].sort((a,b) => b.score - a.score);
            let resultsHTML = '';

            if (lobbyData.surrendered?.uid) {
                const winner = sortedPlayers.find(p => p.uid !== lobbyData.surrendered.uid);
                const loser = sortedPlayers.find(p => p.uid === lobbyData.surrendered.uid);
                if (winner && loser) {
                    resultsHTML = `<h2 class="winner-name">${winner.name} هو الفائز!</h2> <p>${loser.name} استسلم.</p>`;
                } else {
                     resultsHTML = `<h2>انتهت المباراة بالاستسلام</h2>`;
                }
            } else {
                 if (sortedPlayers.length > 0 && (sortedPlayers.length === 1 || sortedPlayers[0].score > sortedPlayers[1].score)) {
                      resultsHTML = `<h2 class="winner-name">الفائز هو: ${sortedPlayers[0].name}</h2>`;
                 } else {
                      resultsHTML = `<h2>انتهت المباراة بالتعادل!</h2>`;
                 }
            }
            allElements.resultsContainer.innerHTML = resultsHTML;
            
            allElements.resultsList.innerHTML = '';
            sortedPlayers.forEach((player, index) => {
                const item = document.createElement('div');
                item.className = 'list-item';
                const medalDisplay = player.medal ? ` ${player.medal}` : '';
                item.innerHTML = `<div><span class="item-rank">${index + 1}</span><span class="item-name">${player.name}${medalDisplay}</span></div><span class="item-value">${player.score} نقطة</span>`;
                allElements.resultsList.appendChild(item);
            });
        }
        
        async function surrender() {
            if (!currentLobbyId || !currentUser) return;
            const lobbyRef = doc(db, "lobbies", currentLobbyId);

            try {
                await runTransaction(db, async (transaction) => {
                    const lobbyDoc = await transaction.get(lobbyRef);
                    if (!lobbyDoc.exists()) throw "Lobby does not exist!";
                    
                    const lobbyData = lobbyDoc.data();

                    if (lobbyData.status !== 'in-progress') return;

                    let finalPlayers = [...lobbyData.players];

                    if (lobbyData.type === '1v1' && lobbyData.players.length === 2) {
                        const winner = lobbyData.players.find(p => p.uid !== currentUser.uid);
                        const winnerIndex = finalPlayers.findIndex(p => p.uid === winner.uid);

                        if (winner && winnerIndex !== -1) {
                            const winnerRef = doc(db, "players", winner.teleoptiId);

                            transaction.update(winnerRef, {
                                score: increment(30),
                                awards: arrayUnion("Botros Race Cup 🏆") 
                            });

                            finalPlayers[winnerIndex].score += 30;
                        }
                    }

                    transaction.update(lobbyRef, {
                        surrendered: { uid: currentUser.uid, teleoptiId: currentPlayerProfile.teleoptiId },
                        status: 'finished',
                        players: finalPlayers
                    });
                });
            } catch (error) {
                console.error("Surrender transaction failed:", error);
            }
        }

        // --- EVENT LISTENERS & INITIALIZATION ---
        function setupEventListeners() {
            document.getElementById('mute-btn')?.addEventListener('click', toggleMusic);
            document.body.addEventListener('click', async (e) => {
                const target = e.target;
                const closest = (selector) => target.closest(selector);

                if (closest('#modal-close-btn')) {
                    allElements.modal.classList.remove('visible');
                }
                else if (closest('.back-btn')) {
                    const parentScreen = closest('.screen-container');
                    if (!parentScreen) return;
                    clearTimeout(questionTimer);
                    if (parentScreen.id === 'online-lobby-screen') return leaveLobby();
                    if (parentScreen.id === 'game-over-screen') {
                        if (unsubscribeLobby) unsubscribeLobby();
                        currentLobbyId = null;
                    }
                    if(parentScreen.id === 'level-select-screen') return displayTiers();
                    updateMainMenu();
                    showScreen('main-menu-screen');
                }
                else if (closest('#login-btn')) handleLogin();
                else if (closest('#logout-btn')) handleLogout();
                else if (closest('#single-player-tab')) { if (currentPlayerProfile) displayTiers(); }
                else if (closest('#online-tab')) showScreen('online-menu-screen');
                else if (closest('#leaderboard-tab')) {
                    showScreen('leaderboard-screen');
                    allElements.leaderboardList.innerHTML = `<p>جار تحميل لوحة الصدارة...</p>`;
                    try {
                        const q = query(collection(db, "players"), orderBy("score", "desc"), limit(50));
                        const snapshot = await getDocs(q);
                        const players = snapshot.docs.map(doc => ({ ...doc.data(), teleoptiId: doc.id }));
                        populateLeaderboard(players);
                    } catch(error) {
                        allElements.leaderboardList.innerHTML = `<p>فشل تحميل لوحة الصدارة.</p>`;
                    }
                }
                else if (closest('#awards-tab')) {
                    if (!currentPlayerProfile) return;
                    await loadPlayerProfile(currentPlayerProfile.teleoptiId);
                    
                    allElements.awardsList.innerHTML = '';
                    const awards = currentPlayerProfile.awards || [];
                    if (awards.length === 0) {
                        allElements.awardsList.innerHTML = `<p style="text-align:center; color: var(--text-secondary);">لم تحصل على أي كؤوس بعد. العب لتربح!</p>`;
                    } else {
                        awards.forEach(award => {
                            const item = document.createElement('div');
                            item.className = 'list-item';
                            item.style.justifyContent = 'center';
                            item.innerHTML = `<span class="item-name">${award}</span>`;
                            allElements.awardsList.appendChild(item);
                        });
                    }
                    showScreen('awards-screen');
                }
                else if (closest('#create-1v1-lobby-btn')) createLobby('1v1');
                else if (closest('#create-massive-lobby-btn')) createLobby('massive');
                else if (closest('#join-lobby-btn')) showScreen('join-lobby-screen');
                else if (closest('#submit-join-lobby-btn')) {
                    const code = allElements.lobbyCodeInput.value.trim();
                    if(code) joinLobby(code); else showAlert("خطأ", "الرجاء إدخال كود المنافسة.");
                }
                else if (closest('#share-whatsapp-btn')) {
                    if (!currentLobbyId) return;
                    const text = `انضم لمنافستي في Botros Race! استخدم الكود ${currentLobbyId} أو اضغط على الرابط:\n${window.location.origin}${window.location.pathname}?lobby=${currentLobbyId}`;
                    window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent(text)}`, '_blank');
                }
                else if (closest('#lobby-code-display')) {
                    if (!currentLobbyId) return;
                    navigator.clipboard.writeText(currentLobbyId).then(() => showAlert('تم النسخ', 'تم نسخ كود الغرفة بنجاح!'));
                }
                else if (closest('#start-game-btn')) startGame();
                else if (closest('#surrender-btn')) surrender();
            });
        }
        
        document.addEventListener('DOMContentLoaded', async () => {
            injectTemplates();
            mapElements();
            setupEventListeners();
        });
    </script>

    <template id="registration-screen-template">
        <div class="form-container">
            <h1 class="screen-title">NC 1 Eagles <br> Botros Race</h1>
            <input id="name-input" type="text" class="input-field" placeholder="الاسم الكامل">
            <input id="teleopti-id-input" type="tel" pattern="[0-9]*" class="input-field" placeholder="Teleopti ID (أرقام فقط)">
            <div class="remember-me-container">
                <input type="checkbox" id="remember-me-checkbox" checked>
                <label for="remember-me-checkbox">تذكرني</label>
            </div>
            <button id="login-btn" class="btn btn-primary">دخول</button>
        </div>
    </template>
    <template id="main-menu-screen-template">
        <div class="welcome-container">
            <h1 id="welcome-message" class="welcome-message"></h1>
            <button id="logout-btn">خروج</button>
        </div>
        <div id="medals-display" class="medals-display"></div>
        <div class="tabs-container">
            <div id="single-player-tab" class="tab-item"><div class="tab-icon">👤</div><div>طور اللعب الفردي</div></div>
            <div id="online-tab" class="tab-item"><div class="tab-icon">👥</div><div>اللعب الجماعي</div></div>
            <div id="leaderboard-tab" class="tab-item"><div class="tab-icon">🏆</div><div>Leaderboard</div></div>
            <div id="awards-tab" class="tab-item"><div class="tab-icon">🎁</div><div>الكؤوس والمكافآت</div></div>
        </div>
    </template>
     <template id="online-menu-screen-template">
        <h1 class="screen-title">ساحات المنافسة المباشرة</h1>
        <div class="button-group">
            <button id="create-1v1-lobby-btn" class="btn btn-primary">⚔️ مواجهة 1 ضد 1</button>
            <button id="create-massive-lobby-btn" class="btn btn-primary">🏟️ إنشاء منافسة حاشدة</button>
            <button id="join-lobby-btn" class="btn btn-secondary">🚪 الانضمام بكود</button>
            <button class="btn btn-secondary back-btn">العودة للقائمة الرئيسية</button>
        </div>
    </template>
    <template id="join-lobby-screen-template">
         <div class="form-container">
            <h1 class="screen-title">الانضمام لمنافسة</h1>
            <p class="screen-subtitle">أدخل كود المنافسة للانضمام إلى زملائك.</p>
            <input id="lobby-code-input" type="text" class="input-field" placeholder="كود المنافسة" style="text-align: center; text-transform: uppercase;">
            <button id="submit-join-lobby-btn" class="btn btn-primary">انضم الآن</button>
            <button class="btn btn-secondary back-btn">العودة</button>
         </div>
    </template>
    <template id="online-lobby-screen-template">
        <h1 id="lobby-title" class="screen-title">غرفة الانتظار</h1>
        <div class="lobby-code-container">
            <div class="lobby-code-label">شارك هذا الكود أو الرابط مع زملائك</div>
            <div id="lobby-code-display" class="lobby-code" title="اضغط للنسخ"></div>
            <button id="share-whatsapp-btn" class="btn btn-whatsapp">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99 0-3.903-.52-5.586-1.456l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.886-.001 2.267.651 4.383 1.873 6.161l-1.057 3.875 3.98-1.048z"></path></svg>
                شارك عبر واتساب
            </button>
        </div>
        <h2 class="screen-subtitle" style="margin-top: 2rem;">اللاعبون المتواجدون</h2>
        <div id="lobby-players-list" class="list-container"></div>
        <div id="lobby-status" class="lobby-status">في انتظار اللاعبين...</div>
        <button id="start-game-btn" class="btn btn-primary" style="margin-top: 1.5rem;" disabled>ابدأ المباراة (للمضيف فقط)</button>
        <button class="btn btn-secondary back-btn">الخروج من الغرفة</button>
    </template>
    <template id="leaderboard-screen-template">
        <h1 class="screen-title">لوحة الصدارة</h1>
        <div id="leaderboard-list" class="list-container"></div>
        <button class="btn btn-secondary back-btn">العودة للقائمة الرئيسية</button>
    </template>
    <template id="awards-screen-template">
        <h1 class="screen-title">الكؤوس والمكافآت</h1>
        <div id="awards-list" class="list-container" style="max-height: 400px; overflow-y: auto;"></div>
        <button class="btn btn-secondary back-btn">العودة للقائمة الرئيسية</button>
    </template>
    <template id="match-screen-template">
        <div id="surrender-banner"></div>
        <h2 id="match-header"></h2>
        <p id="question-counter"></p>
        <div id="timer-container"><div id="timer-bar"></div></div>
        <h3 id="question-text"></h3>
        <div id="options-grid"></div>
        <div id="explanation-box"></div>
        <button id="surrender-btn" class="btn btn-secondary" style="background-color: var(--accent-red); margin-top: 2rem;">استسلام</button>
        <button id="match-back-btn" class="btn btn-secondary back-btn" style="display: none;">العودة للقائمة الرئيسية</button>
    </template>
    <template id="game-over-screen-template">
        <h1 class="screen-title">انتهت المباراة!</h1>
        <div id="results-container"></div>
        <div id="results-list" class="list-container" style="margin-top: 2rem;"></div>
        <button class="btn btn-primary back-btn">العودة للقائمة الرئيسية</button>
    </template>
     <template id="modal-template">
        <div class="modal-content">
            <h2 id="modal-title" class="modal-title"></h2>
            <p id="modal-body" class="modal-body"></p>
            <div class="modal-actions">
                <button id="modal-close-btn" class="btn btn-primary">حسنًا</button>
            </div>
        </div>
    </template>
     <template id="single-player-menu-screen-template">
        <h1 class="screen-title">طور اللعب الفردي</h1>
        <p class="screen-subtitle">أكمل المستويات لتفتح تحديات أصعب وتحصل على ميداليات.</p>
        <div id="tiers-grid" class="tiers-grid"></div>
        <button class="btn btn-secondary back-btn">العودة للقائمة الرئيسية</button>
    </template>
    <template id="level-select-screen-template">
        <h1 id="level-select-title" class="screen-title"></h1>
        <div id="levels-grid" class="levels-grid"></div>
        <button class="btn btn-secondary back-btn">العودة للمستويات</button>
    </template>
</body>
</html>
